<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>APS 240: Data Analysis and Statistics with R</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Course book for Data Analysis and Statistics with R (APS 240) in the Department of Animal and Plant Sciences, University of Sheffield">
  <meta name="generator" content="bookdown 0.1.5 and GitBook 2.6.7">

  <meta property="og:title" content="APS 240: Data Analysis and Statistics with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course book for Data Analysis and Statistics with R (APS 240) in the Department of Animal and Plant Sciences, University of Sheffield" />
  <meta name="github-repo" content="dzchilds/stats-for-bio" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="APS 240: Data Analysis and Statistics with R" />
  
  <meta name="twitter:description" content="Course book for Data Analysis and Statistics with R (APS 240) in the Department of Animal and Plant Sciences, University of Sheffield" />
  

<meta name="author" content="Dylan Z. Childs">

<meta name="date" content="2016-11-22">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="introduction-to-two-way-anova.html">
<link rel="next" href="anova-for-randomised-block-designs.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<style type="text/css">

.warning-box {
  border: 3px solid #e60000;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.advanced-box {
  border: 3px solid #268bd2;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

.do-something {
  border: 3px solid #803e00;
  margin:  25px;
  padding: 10px 10px 5px 10px;
  border-radius: 6px 6px 6px 6px;
}

</style>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">APS 240</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Course information and overview</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#why-data-analysis"><i class="fa fa-check"></i><b>1.1</b> Why do a data analysis course?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#overview"><i class="fa fa-check"></i><b>1.2</b> Course overview</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#aims"><i class="fa fa-check"></i><b>1.2.1</b> Aims</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#objectives"><i class="fa fa-check"></i><b>1.2.2</b> Objectives</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#assumed-background"><i class="fa fa-check"></i><b>1.2.3</b> Assumed background</a></li>
<li class="chapter" data-level="1.2.4" data-path="index.html"><a href="index.html#methods"><i class="fa fa-check"></i><b>1.2.4</b> Methods</a></li>
<li class="chapter" data-level="1.2.5" data-path="index.html"><a href="index.html#non-assessed-material"><i class="fa fa-check"></i><b>1.2.5</b> Non-assessed material</a></li>
<li class="chapter" data-level="1.2.6" data-path="index.html"><a href="index.html#what-is-required-of-you"><i class="fa fa-check"></i><b>1.2.6</b> What is required of you?</a></li>
<li class="chapter" data-level="1.2.7" data-path="index.html"><a href="index.html#assessment"><i class="fa fa-check"></i><b>1.2.7</b> Assessment</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#how-to-use-the-teaching-material"><i class="fa fa-check"></i><b>1.3</b> How to use the teaching material</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#printed-material"><i class="fa fa-check"></i><b>1.3.1</b> The online course book</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#printed-material"><i class="fa fa-check"></i><b>1.3.2</b> Printed material</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#how-to-make-best-use-of-it"><i class="fa fa-check"></i><b>1.3.3</b> How to make best use of the teaching material</a></li>
<li class="chapter" data-level="1.3.4" data-path="index.html"><a href="index.html#conventions"><i class="fa fa-check"></i><b>1.3.4</b> Conventions used in the course material</a></li>
<li class="chapter" data-level="1.3.5" data-path="index.html"><a href="index.html#feedback"><i class="fa fa-check"></i><b>1.3.5</b> Feedback</a></li>
<li class="chapter" data-level="1.3.6" data-path="index.html"><a href="index.html#help"><i class="fa fa-check"></i><b>1.3.6</b> Help sessions</a></li>
<li class="chapter" data-level="1.3.7" data-path="index.html"><a href="index.html#overall"><i class="fa fa-check"></i><b>1.3.7</b> Overall…</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#health-and-safety"><i class="fa fa-check"></i><b>1.4</b> Health and safety using display screen equipment</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="expected-learning-outcomes.html"><a href="expected-learning-outcomes.html"><i class="fa fa-check"></i><b>2</b> Expected learning outcomes</a><ul>
<li class="chapter" data-level="2.1" data-path="expected-learning-outcomes.html"><a href="expected-learning-outcomes.html#statistical-concepts-i"><i class="fa fa-check"></i><b>2.1</b> Statistical Concepts (I)</a></li>
<li class="chapter" data-level="2.2" data-path="expected-learning-outcomes.html"><a href="expected-learning-outcomes.html#statistical-concepts-ii"><i class="fa fa-check"></i><b>2.2</b> Statistical Concepts (II)</a></li>
<li class="chapter" data-level="2.3" data-path="expected-learning-outcomes.html"><a href="expected-learning-outcomes.html#simple-parametric-statistics-t-tests"><i class="fa fa-check"></i><b>2.3</b> Simple parametric statistics (<em>t</em>-tests)</a></li>
<li class="chapter" data-level="2.4" data-path="expected-learning-outcomes.html"><a href="expected-learning-outcomes.html#categorical-data-chi-square-tests"><i class="fa fa-check"></i><b>2.4</b> Categorical Data (chi-square tests)</a></li>
<li class="chapter" data-level="2.5" data-path="expected-learning-outcomes.html"><a href="expected-learning-outcomes.html#associations-and-relationships-regression"><i class="fa fa-check"></i><b>2.5</b> Associations and Relationships (regression)</a></li>
<li class="chapter" data-level="2.6" data-path="expected-learning-outcomes.html"><a href="expected-learning-outcomes.html#associations-and-relationships-correlation"><i class="fa fa-check"></i><b>2.6</b> Associations and Relationships (correlation)</a></li>
<li class="chapter" data-level="2.7" data-path="expected-learning-outcomes.html"><a href="expected-learning-outcomes.html#experimental-design-and-anova-i"><i class="fa fa-check"></i><b>2.7</b> Experimental Design and ANOVA (I)</a></li>
<li class="chapter" data-level="2.8" data-path="expected-learning-outcomes.html"><a href="expected-learning-outcomes.html#experimental-design-and-anova-ii"><i class="fa fa-check"></i><b>2.8</b> Experimental Design and ANOVA (II)</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="programming-prerequisites.html"><a href="programming-prerequisites.html"><i class="fa fa-check"></i><b>3</b> Programming prerequisites</a><ul>
<li class="chapter" data-level="3.1" data-path="programming-prerequisites.html"><a href="programming-prerequisites.html#starting-an-r-session-in-rstudio"><i class="fa fa-check"></i><b>3.1</b> Starting an R session in RStudio</a></li>
<li class="chapter" data-level="3.2" data-path="programming-prerequisites.html"><a href="programming-prerequisites.html#using-packages"><i class="fa fa-check"></i><b>3.2</b> Using packages</a></li>
<li class="chapter" data-level="3.3" data-path="programming-prerequisites.html"><a href="programming-prerequisites.html#reading-data-into-r"><i class="fa fa-check"></i><b>3.3</b> Reading data into R</a></li>
<li class="chapter" data-level="3.4" data-path="programming-prerequisites.html"><a href="programming-prerequisites.html#data-frames"><i class="fa fa-check"></i><b>3.4</b> Data frames</a></li>
<li class="chapter" data-level="3.5" data-path="programming-prerequisites.html"><a href="programming-prerequisites.html#package-functions"><i class="fa fa-check"></i><b>3.5</b> Package functions</a></li>
</ul></li>
<li class="part"><span><b>Statistical Concepts (I)</b></span></li>
<li class="chapter" data-level="4" data-path="the-scientific-process.html"><a href="the-scientific-process.html"><i class="fa fa-check"></i><b>4</b> The scientific process</a><ul>
<li class="chapter" data-level="4.1" data-path="the-scientific-process.html"><a href="the-scientific-process.html#stages-scientific-process"><i class="fa fa-check"></i><b>4.1</b> Stages in the scientific process</a><ul>
<li class="chapter" data-level="4.1.1" data-path="the-scientific-process.html"><a href="the-scientific-process.html#stages-observations"><i class="fa fa-check"></i><b>4.1.1</b> Observations</a></li>
<li class="chapter" data-level="4.1.2" data-path="the-scientific-process.html"><a href="the-scientific-process.html#stages-questions"><i class="fa fa-check"></i><b>4.1.2</b> Questions</a></li>
<li class="chapter" data-level="4.1.3" data-path="the-scientific-process.html"><a href="the-scientific-process.html#stages-hypotheses"><i class="fa fa-check"></i><b>4.1.3</b> Hypotheses</a></li>
<li class="chapter" data-level="4.1.4" data-path="the-scientific-process.html"><a href="the-scientific-process.html#stages-predictions"><i class="fa fa-check"></i><b>4.1.4</b> Predictions</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="the-scientific-process.html"><a href="the-scientific-process.html#hypothesis-testing"><i class="fa fa-check"></i><b>4.2</b> Hypothesis testing</a></li>
<li class="chapter" data-level="4.3" data-path="the-scientific-process.html"><a href="the-scientific-process.html#are-we-sure"><i class="fa fa-check"></i><b>4.3</b> Don’t we ever know anything for sure?</a></li>
<li class="chapter" data-level="4.4" data-path="the-scientific-process.html"><a href="the-scientific-process.html#further-reading"><i class="fa fa-check"></i><b>4.4</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-and-variables.html"><a href="data-and-variables.html"><i class="fa fa-check"></i><b>5</b> Data and variables</a><ul>
<li class="chapter" data-level="5.1" data-path="data-and-variables.html"><a href="data-and-variables.html#observations-on-material-and-obvious-things"><i class="fa fa-check"></i><b>5.1</b> “Observations on material and obvious things”</a></li>
<li class="chapter" data-level="5.2" data-path="data-and-variables.html"><a href="data-and-variables.html#var-types"><i class="fa fa-check"></i><b>5.2</b> Revision: Types of variable</a><ul>
<li class="chapter" data-level="5.2.1" data-path="data-and-variables.html"><a href="data-and-variables.html#nominal-categorical-variables"><i class="fa fa-check"></i><b>5.2.1</b> Nominal (categorical) variables</a></li>
<li class="chapter" data-level="5.2.2" data-path="data-and-variables.html"><a href="data-and-variables.html#ordinal-categorical-data"><i class="fa fa-check"></i><b>5.2.2</b> Ordinal (categorical) data</a></li>
<li class="chapter" data-level="5.2.3" data-path="data-and-variables.html"><a href="data-and-variables.html#interval-scale-numeric-variables"><i class="fa fa-check"></i><b>5.2.3</b> Interval scale (numeric) variables</a></li>
<li class="chapter" data-level="5.2.4" data-path="data-and-variables.html"><a href="data-and-variables.html#ratio-scale-numeric-variables"><i class="fa fa-check"></i><b>5.2.4</b> Ratio scale (numeric) variables</a></li>
<li class="chapter" data-level="5.2.5" data-path="data-and-variables.html"><a href="data-and-variables.html#which-is-best"><i class="fa fa-check"></i><b>5.2.5</b> Which is best?</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-and-variables.html"><a href="data-and-variables.html#accuracy-precision"><i class="fa fa-check"></i><b>5.3</b> Accuracy and precision</a><ul>
<li class="chapter" data-level="5.3.1" data-path="data-and-variables.html"><a href="data-and-variables.html#what-do-they-mean"><i class="fa fa-check"></i><b>5.3.1</b> What do they mean?</a></li>
<li class="chapter" data-level="5.3.2" data-path="data-and-variables.html"><a href="data-and-variables.html#implied-precision---significant-figures"><i class="fa fa-check"></i><b>5.3.2</b> Implied precision - significant figures</a></li>
<li class="chapter" data-level="5.3.3" data-path="data-and-variables.html"><a href="data-and-variables.html#how-precise-should-measurements-be"><i class="fa fa-check"></i><b>5.3.3</b> How precise should measurements be?</a></li>
<li class="chapter" data-level="5.3.4" data-path="data-and-variables.html"><a href="data-and-variables.html#error-bias-and-prejudice"><i class="fa fa-check"></i><b>5.3.4</b> Error, bias and prejudice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="learning-from-data.html"><a href="learning-from-data.html"><i class="fa fa-check"></i><b>6</b> Learning from data</a><ul>
<li class="chapter" data-level="6.1" data-path="learning-from-data.html"><a href="learning-from-data.html#populations"><i class="fa fa-check"></i><b>6.1</b> Populations</a></li>
<li class="chapter" data-level="6.2" data-path="learning-from-data.html"><a href="learning-from-data.html#learning-about-populations"><i class="fa fa-check"></i><b>6.2</b> Learning about populations</a></li>
<li class="chapter" data-level="6.3" data-path="learning-from-data.html"><a href="learning-from-data.html#morph-example"><i class="fa fa-check"></i><b>6.3</b> A simple example</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sampling-error.html"><a href="sampling-error.html"><i class="fa fa-check"></i><b>7</b> Sampling error</a><ul>
<li class="chapter" data-level="7.1" data-path="sampling-error.html"><a href="sampling-error.html#sampling-error-1"><i class="fa fa-check"></i><b>7.1</b> Sampling error</a></li>
<li class="chapter" data-level="7.2" data-path="sampling-error.html"><a href="sampling-error.html#sampling-distributions"><i class="fa fa-check"></i><b>7.2</b> Sampling distributions</a></li>
<li class="chapter" data-level="7.3" data-path="sampling-error.html"><a href="sampling-error.html#the-effect-of-sample-size"><i class="fa fa-check"></i><b>7.3</b> The effect of sample size</a></li>
<li class="chapter" data-level="7.4" data-path="sampling-error.html"><a href="sampling-error.html#the-standard-error"><i class="fa fa-check"></i><b>7.4</b> The standard error</a></li>
<li class="chapter" data-level="7.5" data-path="sampling-error.html"><a href="sampling-error.html#what-is-the-point-of-all-this"><i class="fa fa-check"></i><b>7.5</b> What is the point of all this!?</a></li>
</ul></li>
<li class="part"><span><b>Statistical Concepts (II)</b></span></li>
<li class="chapter" data-level="8" data-path="statistical-significance-and-p-values.html"><a href="statistical-significance-and-p-values.html"><i class="fa fa-check"></i><b>8</b> Statistical significance and <em>p</em>-values</a><ul>
<li class="chapter" data-level="8.1" data-path="statistical-significance-and-p-values.html"><a href="statistical-significance-and-p-values.html#bootstrap"><i class="fa fa-check"></i><b>8.1</b> Estimating a sampling distribution</a><ul>
<li class="chapter" data-level="8.1.1" data-path="statistical-significance-and-p-values.html"><a href="statistical-significance-and-p-values.html#bootstrap-overview"><i class="fa fa-check"></i><b>8.1.1</b> Overview of bootstrapping</a></li>
<li class="chapter" data-level="8.1.2" data-path="statistical-significance-and-p-values.html"><a href="statistical-significance-and-p-values.html#doing-it-for-real"><i class="fa fa-check"></i><b>8.1.2</b> Doing it for real</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="statistical-significance-and-p-values.html"><a href="statistical-significance-and-p-values.html#statistical-significance"><i class="fa fa-check"></i><b>8.2</b> Statistical significance</a></li>
<li class="chapter" data-level="8.3" data-path="statistical-significance-and-p-values.html"><a href="statistical-significance-and-p-values.html#concluding-remarks"><i class="fa fa-check"></i><b>8.3</b> Concluding remarks</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="comparing-populations.html"><a href="comparing-populations.html"><i class="fa fa-check"></i><b>9</b> Comparing populations</a><ul>
<li class="chapter" data-level="9.1" data-path="comparing-populations.html"><a href="comparing-populations.html#making-comparisons"><i class="fa fa-check"></i><b>9.1</b> Making comparisons</a></li>
<li class="chapter" data-level="9.2" data-path="comparing-populations.html"><a href="comparing-populations.html#morph-weights-eg"><i class="fa fa-check"></i><b>9.2</b> A new example</a></li>
<li class="chapter" data-level="9.3" data-path="comparing-populations.html"><a href="comparing-populations.html#evaluating-differences-between-population-means"><i class="fa fa-check"></i><b>9.3</b> Evaluating differences between population means</a></li>
<li class="chapter" data-level="9.4" data-path="comparing-populations.html"><a href="comparing-populations.html#a-permutation-test"><i class="fa fa-check"></i><b>9.4</b> A permutation test</a></li>
<li class="chapter" data-level="9.5" data-path="comparing-populations.html"><a href="comparing-populations.html#what-have-we-learned"><i class="fa fa-check"></i><b>9.5</b> What have we learned?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="hypotheses-and-p-values.html"><a href="hypotheses-and-p-values.html"><i class="fa fa-check"></i><b>10</b> Hypotheses and <em>p</em>-values</a><ul>
<li class="chapter" data-level="10.1" data-path="hypotheses-and-p-values.html"><a href="hypotheses-and-p-values.html#a-few-words-about-the-null-hypothesis"><i class="fa fa-check"></i><b>10.1</b> A few words about the null hypothesis</a><ul>
<li class="chapter" data-level="10.1.1" data-path="hypotheses-and-p-values.html"><a href="hypotheses-and-p-values.html#hypotheses-and-null-hypotheses"><i class="fa fa-check"></i><b>10.1.1</b> Hypotheses and null hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="hypotheses-and-p-values.html"><a href="hypotheses-and-p-values.html#interpreting-and-reporting-p-values"><i class="fa fa-check"></i><b>10.2</b> Interpreting and reporting <em>p</em>-values</a><ul>
<li class="chapter" data-level="10.2.1" data-path="hypotheses-and-p-values.html"><a href="hypotheses-and-p-values.html#what-if-p-is-close-to-0.05"><i class="fa fa-check"></i><b>10.2.1</b> What if <em>p</em> is close to 0.05?</a></li>
<li class="chapter" data-level="10.2.2" data-path="hypotheses-and-p-values.html"><a href="hypotheses-and-p-values.html#presenting-p-values"><i class="fa fa-check"></i><b>10.2.2</b> Presenting <em>p</em>-values</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="hypotheses-and-p-values.html"><a href="hypotheses-and-p-values.html#biological-vs.statistical-significance"><i class="fa fa-check"></i><b>10.3</b> Biological vs. statistical significance</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="parametric-statistics.html"><a href="parametric-statistics.html"><i class="fa fa-check"></i><b>11</b> Parametric statistics</a><ul>
<li class="chapter" data-level="11.1" data-path="parametric-statistics.html"><a href="parametric-statistics.html#introduction"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="parametric-statistics.html"><a href="parametric-statistics.html#math-models"><i class="fa fa-check"></i><b>11.2</b> Mathematical models</a></li>
<li class="chapter" data-level="11.3" data-path="parametric-statistics.html"><a href="parametric-statistics.html#parametric-stats"><i class="fa fa-check"></i><b>11.3</b> The normal distribution</a><ul>
<li class="chapter" data-level="11.3.1" data-path="parametric-statistics.html"><a href="parametric-statistics.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>11.3.1</b> Standard error of the mean</a></li>
<li class="chapter" data-level="11.3.2" data-path="parametric-statistics.html"><a href="parametric-statistics.html#the-t-distribution"><i class="fa fa-check"></i><b>11.3.2</b> The <em>t</em> distribution</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Simple Parametric Statistics</b></span></li>
<li class="chapter" data-level="12" data-path="one-sample-t-tests.html"><a href="one-sample-t-tests.html"><i class="fa fa-check"></i><b>12</b> One sample <em>t</em>-tests</a><ul>
<li class="chapter" data-level="12.1" data-path="one-sample-t-tests.html"><a href="one-sample-t-tests.html#when-do-we-use-one-sample-t-test"><i class="fa fa-check"></i><b>12.1</b> When do we use one-sample <em>t</em>-test?</a></li>
<li class="chapter" data-level="12.2" data-path="one-sample-t-tests.html"><a href="one-sample-t-tests.html#how-does-the-one-sample-t-test-work"><i class="fa fa-check"></i><b>12.2</b> How does the one-sample <em>t</em>-test work?</a><ul>
<li class="chapter" data-level="12.2.1" data-path="one-sample-t-tests.html"><a href="one-sample-t-tests.html#assumptions-of-the-one-sample-t-test"><i class="fa fa-check"></i><b>12.2.1</b> Assumptions of the one-sample <em>t</em>-test</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="one-sample-t-tests.html"><a href="one-sample-t-tests.html#carrying-out-a-one-sample-t-test-in-r"><i class="fa fa-check"></i><b>12.3</b> Carrying out a one-sample <em>t</em>-test in R</a><ul>
<li class="chapter" data-level="12.3.1" data-path="one-sample-t-tests.html"><a href="one-sample-t-tests.html#visualising-the-data-and-checking-the-assumptions"><i class="fa fa-check"></i><b>12.3.1</b> Visualising the data and checking the assumptions</a></li>
<li class="chapter" data-level="12.3.2" data-path="one-sample-t-tests.html"><a href="one-sample-t-tests.html#carrying-out-the-test"><i class="fa fa-check"></i><b>12.3.2</b> Carrying out the test</a></li>
<li class="chapter" data-level="12.3.3" data-path="one-sample-t-tests.html"><a href="one-sample-t-tests.html#summarising-the-result"><i class="fa fa-check"></i><b>12.3.3</b> Summarising the result</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html"><i class="fa fa-check"></i><b>13</b> Two-sample <em>t</em>-test</a><ul>
<li class="chapter" data-level="13.1" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html#when-do-we-use-a-two-sample-t-test"><i class="fa fa-check"></i><b>13.1</b> When do we use a two-sample <em>t</em>-test?</a></li>
<li class="chapter" data-level="13.2" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html#how-does-the-two-sample-t-test-work"><i class="fa fa-check"></i><b>13.2</b> How does the two-sample <em>t</em>-test work?</a><ul>
<li class="chapter" data-level="13.2.1" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html#assumptions-of-the-two-sample-t-test"><i class="fa fa-check"></i><b>13.2.1</b> Assumptions of the two-sample <em>t</em>-test</a></li>
<li class="chapter" data-level="13.2.2" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html#what-about-the-equal-variance-assumption"><i class="fa fa-check"></i><b>13.2.2</b> What about the <em>equal variance</em> assumption?</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html#carrying-out-a-two-sample-t-test-in-r"><i class="fa fa-check"></i><b>13.3</b> Carrying out a two-sample <em>t</em>-test in R</a><ul>
<li class="chapter" data-level="13.3.1" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html#visualising-the-data-and-checking-the-assumptions-1"><i class="fa fa-check"></i><b>13.3.1</b> Visualising the data and checking the assumptions</a></li>
<li class="chapter" data-level="13.3.2" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html#carrying-out-the-test-1"><i class="fa fa-check"></i><b>13.3.2</b> Carrying out the test</a></li>
<li class="chapter" data-level="13.3.3" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html#summarising-the-result-1"><i class="fa fa-check"></i><b>13.3.3</b> Summarising the result</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="paired-sample-t-tests.html"><a href="paired-sample-t-tests.html"><i class="fa fa-check"></i><b>14</b> Paired-sample <em>t</em>-tests</a><ul>
<li class="chapter" data-level="14.1" data-path="paired-sample-t-tests.html"><a href="paired-sample-t-tests.html#when-do-we-use-a-paired-sample-t-test"><i class="fa fa-check"></i><b>14.1</b> When do we use a paired-sample <em>t</em>-test?</a></li>
<li class="chapter" data-level="14.2" data-path="paired-sample-t-tests.html"><a href="paired-sample-t-tests.html#why-do-we-use-a-paired-sample-design"><i class="fa fa-check"></i><b>14.2</b> Why do we use a paired-sample design?</a></li>
<li class="chapter" data-level="14.3" data-path="paired-sample-t-tests.html"><a href="paired-sample-t-tests.html#how-do-you-carry-out-a-t-test-on-paired-samples"><i class="fa fa-check"></i><b>14.3</b> How do you carry out a <em>t</em>-test on paired-samples?</a><ul>
<li class="chapter" data-level="14.3.1" data-path="paired-sample-t-tests.html"><a href="paired-sample-t-tests.html#assumptions-of-the-one-sample-t-test-1"><i class="fa fa-check"></i><b>14.3.1</b> Assumptions of the one-sample <em>t</em>-test</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="paired-sample-t-tests.html"><a href="paired-sample-t-tests.html#carrying-out-a-paired-sample-t-test-in-r"><i class="fa fa-check"></i><b>14.4</b> Carrying out a paired-sample <em>t</em>-test in R</a><ul>
<li class="chapter" data-level="14.4.1" data-path="paired-sample-t-tests.html"><a href="paired-sample-t-tests.html#using-the-paired-true-argument"><i class="fa fa-check"></i><b>14.4.1</b> Using the <code>paired = TRUE</code> argument</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="one-tailed-vs-two-tailed-tests.html"><a href="one-tailed-vs-two-tailed-tests.html"><i class="fa fa-check"></i><b>15</b> One-tailed vs. two-tailed tests</a><ul>
<li class="chapter" data-level="15.1" data-path="one-tailed-vs-two-tailed-tests.html"><a href="one-tailed-vs-two-tailed-tests.html#introduction-1"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="one-tailed-vs-two-tailed-tests.html"><a href="one-tailed-vs-two-tailed-tests.html#an-example-of-a-one-tailed-hypothesis"><i class="fa fa-check"></i><b>15.2</b> An example of a one-tailed hypothesis</a></li>
<li class="chapter" data-level="15.3" data-path="one-tailed-vs-two-tailed-tests.html"><a href="one-tailed-vs-two-tailed-tests.html#so-how-do-we-perform-a-one-tailed-t-test"><i class="fa fa-check"></i><b>15.3</b> So how do we perform a one-tailed <em>t</em>-test?</a><ul>
<li class="chapter" data-level="15.3.1" data-path="one-tailed-vs-two-tailed-tests.html"><a href="one-tailed-vs-two-tailed-tests.html#carrying-out-one-tailed-t-tests-in-r"><i class="fa fa-check"></i><b>15.3.1</b> Carrying out one-tailed <em>t</em>-tests in R</a></li>
<li class="chapter" data-level="15.3.2" data-path="one-tailed-vs-two-tailed-tests.html"><a href="one-tailed-vs-two-tailed-tests.html#when-to-use-and-not-to-use-one-tailed-t-tests"><i class="fa fa-check"></i><b>15.3.2</b> When to use, and not to use, one-tailed <em>t</em>-tests</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Categorical Data</b></span></li>
<li class="chapter" data-level="16" data-path="working-with-frequencies.html"><a href="working-with-frequencies.html"><i class="fa fa-check"></i><b>16</b> Working with frequencies</a><ul>
<li class="chapter" data-level="16.1" data-path="working-with-frequencies.html"><a href="working-with-frequencies.html#introduction-2"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="working-with-frequencies.html"><a href="working-with-frequencies.html#a-new-kind-of-distribution"><i class="fa fa-check"></i><b>16.2</b> A new kind of distribution</a></li>
<li class="chapter" data-level="16.3" data-path="working-with-frequencies.html"><a href="working-with-frequencies.html#types-of-test"><i class="fa fa-check"></i><b>16.3</b> Types of test</a><ul>
<li class="chapter" data-level="16.3.1" data-path="working-with-frequencies.html"><a href="working-with-frequencies.html#chi2-goodness-of-fit-test"><i class="fa fa-check"></i><b>16.3.1</b> <span class="math inline">\(\chi^{2}\)</span> goodness of fit test</a></li>
<li class="chapter" data-level="16.3.2" data-path="working-with-frequencies.html"><a href="working-with-frequencies.html#chi2-contingency-table-test"><i class="fa fa-check"></i><b>16.3.2</b> <span class="math inline">\(\chi^{2}\)</span> contingency table test</a></li>
<li class="chapter" data-level="16.3.3" data-path="working-with-frequencies.html"><a href="working-with-frequencies.html#the-assumptions-and-requirements-of-chi2-tests"><i class="fa fa-check"></i><b>16.3.3</b> The assumptions and requirements of <span class="math inline">\(\chi^{2}\)</span> tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="goodness-of-fit-tests.html"><a href="goodness-of-fit-tests.html"><i class="fa fa-check"></i><b>17</b> Goodness of fit tests</a><ul>
<li class="chapter" data-level="17.1" data-path="goodness-of-fit-tests.html"><a href="goodness-of-fit-tests.html#when-do-we-use-a-chi-square-goodness-of-fit-test"><i class="fa fa-check"></i><b>17.1</b> When do we use a chi-square goodness of fit test?</a></li>
<li class="chapter" data-level="17.2" data-path="goodness-of-fit-tests.html"><a href="goodness-of-fit-tests.html#how-does-the-chi-square-goodness-of-fit-test-work"><i class="fa fa-check"></i><b>17.2</b> How does the chi-square goodness of fit test work?</a><ul>
<li class="chapter" data-level="17.2.1" data-path="goodness-of-fit-tests.html"><a href="goodness-of-fit-tests.html#assumptions-of-the-chi-square-goodness-of-fit-test"><i class="fa fa-check"></i><b>17.2.1</b> Assumptions of the chi-square goodness of fit test</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="goodness-of-fit-tests.html"><a href="goodness-of-fit-tests.html#carrying-out-a-chi-square-goodness-of-fit-test-in-r"><i class="fa fa-check"></i><b>17.3</b> Carrying out a chi-square goodness of fit test in R</a><ul>
<li class="chapter" data-level="17.3.1" data-path="goodness-of-fit-tests.html"><a href="goodness-of-fit-tests.html#summarising-the-result-2"><i class="fa fa-check"></i><b>17.3.1</b> Summarising the result</a></li>
<li class="chapter" data-level="17.3.2" data-path="goodness-of-fit-tests.html"><a href="goodness-of-fit-tests.html#a-bit-more-about-goodness-of-fit-tests-in-r"><i class="fa fa-check"></i><b>17.3.2</b> A bit more about goodness of fit tests in R</a></li>
<li class="chapter" data-level="17.3.3" data-path="goodness-of-fit-tests.html"><a href="goodness-of-fit-tests.html#doing-it-the-long-way"><i class="fa fa-check"></i><b>17.3.3</b> Doing it the long way…</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="goodness-of-fit-tests.html"><a href="goodness-of-fit-tests.html#determining-appropriate-expected-values"><i class="fa fa-check"></i><b>17.4</b> Determining appropriate expected values</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="contingency-tables.html"><a href="contingency-tables.html"><i class="fa fa-check"></i><b>18</b> Contingency tables</a><ul>
<li class="chapter" data-level="18.1" data-path="contingency-tables.html"><a href="contingency-tables.html#when-do-we-use-a-chi-square-contingency-table-test"><i class="fa fa-check"></i><b>18.1</b> When do we use a chi-square contingency table test?</a></li>
<li class="chapter" data-level="18.2" data-path="contingency-tables.html"><a href="contingency-tables.html#how-does-the-chi-square-contingency-table-test-work"><i class="fa fa-check"></i><b>18.2</b>  How does the chi-square contingency table test work?</a><ul>
<li class="chapter" data-level="18.2.1" data-path="contingency-tables.html"><a href="contingency-tables.html#assumptions-of-the-chi-square-contingency-table-test"><i class="fa fa-check"></i><b>18.2.1</b> Assumptions of the chi-square contingency table test</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="contingency-tables.html"><a href="contingency-tables.html#carrying-out-a-chi-square-contingency-table-test-in-r"><i class="fa fa-check"></i><b>18.3</b> Carrying out a chi-square contingency table test in R</a><ul>
<li class="chapter" data-level="18.3.1" data-path="contingency-tables.html"><a href="contingency-tables.html#step-1.-getting-the-data-into-the-correct-format"><i class="fa fa-check"></i><b>18.3.1</b> Step 1. Getting the data into the correct format</a></li>
<li class="chapter" data-level="18.3.2" data-path="contingency-tables.html"><a href="contingency-tables.html#step-2.-doing-the-test"><i class="fa fa-check"></i><b>18.3.2</b> Step 2. Doing the test</a></li>
<li class="chapter" data-level="18.3.3" data-path="contingency-tables.html"><a href="contingency-tables.html#summarising-the-result-3"><i class="fa fa-check"></i><b>18.3.3</b> Summarising the result</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="contingency-tables.html"><a href="contingency-tables.html#working-with-larger-tables"><i class="fa fa-check"></i><b>18.4</b> Working with larger tables</a></li>
</ul></li>
<li class="part"><span><b>Associations and Relationships</b></span></li>
<li class="chapter" data-level="19" data-path="relationships-and-regression.html"><a href="relationships-and-regression.html"><i class="fa fa-check"></i><b>19</b> Relationships and regression</a><ul>
<li class="chapter" data-level="19.1" data-path="relationships-and-regression.html"><a href="relationships-and-regression.html#introduction-3"><i class="fa fa-check"></i><b>19.1</b> Introduction</a></li>
<li class="chapter" data-level="19.2" data-path="relationships-and-regression.html"><a href="relationships-and-regression.html#what-does-linear-regression-do"><i class="fa fa-check"></i><b>19.2</b> What does linear regression do?</a></li>
<li class="chapter" data-level="19.3" data-path="relationships-and-regression.html"><a href="relationships-and-regression.html#how-does-simple-linear-regression-work"><i class="fa fa-check"></i><b>19.3</b> How does simple linear regression work?</a><ul>
<li class="chapter" data-level="19.3.1" data-path="relationships-and-regression.html"><a href="relationships-and-regression.html#finding-the-best-fit-line"><i class="fa fa-check"></i><b>19.3.1</b> Finding the best fit line</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="relationships-and-regression.html"><a href="relationships-and-regression.html#what-do-you-get-out-of-a-regression"><i class="fa fa-check"></i><b>19.4</b> What do you get out of a regression?</a><ul>
<li class="chapter" data-level="19.4.1" data-path="relationships-and-regression.html"><a href="relationships-and-regression.html#interpreting-a-regression"><i class="fa fa-check"></i><b>19.4.1</b> Interpreting a regression</a></li>
<li class="chapter" data-level="19.4.2" data-path="relationships-and-regression.html"><a href="relationships-and-regression.html#evaluating-hypotheses-inference"><i class="fa fa-check"></i><b>19.4.2</b> Evaluating hypotheses (‘inference’)</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="relationships-and-regression.html"><a href="relationships-and-regression.html#the-assumptions-of-regression"><i class="fa fa-check"></i><b>19.5</b> The assumptions of regression</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="simple-regression-in-r.html"><a href="simple-regression-in-r.html"><i class="fa fa-check"></i><b>20</b> Simple regression in R</a><ul>
<li class="chapter" data-level="20.1" data-path="simple-regression-in-r.html"><a href="simple-regression-in-r.html#regression-in-R"><i class="fa fa-check"></i><b>20.1</b> Carrying out a simple linear regression in R</a></li>
<li class="chapter" data-level="20.2" data-path="simple-regression-in-r.html"><a href="simple-regression-in-r.html#first-steps"><i class="fa fa-check"></i><b>20.2</b> First steps</a><ul>
<li class="chapter" data-level="20.2.1" data-path="simple-regression-in-r.html"><a href="simple-regression-in-r.html#visualising-the-data"><i class="fa fa-check"></i><b>20.2.1</b> Visualising the data</a></li>
<li class="chapter" data-level="20.2.2" data-path="simple-regression-in-r.html"><a href="simple-regression-in-r.html#checking-the-assumptions"><i class="fa fa-check"></i><b>20.2.2</b> Checking the assumptions</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="simple-regression-in-r.html"><a href="simple-regression-in-r.html#model-fitting-and-significance-tests"><i class="fa fa-check"></i><b>20.3</b> Model fitting and significance tests</a><ul>
<li class="chapter" data-level="20.3.1" data-path="simple-regression-in-r.html"><a href="simple-regression-in-r.html#extracting-a-little-more-information"><i class="fa fa-check"></i><b>20.3.1</b> Extracting a little more information</a></li>
<li class="chapter" data-level="20.3.2" data-path="simple-regression-in-r.html"><a href="simple-regression-in-r.html#residual-analysis"><i class="fa fa-check"></i><b>20.3.2</b> Residual analysis</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="simple-regression-in-r.html"><a href="simple-regression-in-r.html#present-results"><i class="fa fa-check"></i><b>20.4</b> Presenting results</a><ul>
<li class="chapter" data-level="20.4.1" data-path="simple-regression-in-r.html"><a href="simple-regression-in-r.html#plotting-the-fitted-line-and-the-data"><i class="fa fa-check"></i><b>20.4.1</b> Plotting the fitted line and the data</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="simple-regression-in-r.html"><a href="simple-regression-in-r.html#causation"><i class="fa fa-check"></i><b>20.5</b> What about causation?</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html"><i class="fa fa-check"></i><b>21</b> Regression diagnostics</a><ul>
<li class="chapter" data-level="21.1" data-path="parametric-statistics.html"><a href="parametric-statistics.html#introduction"><i class="fa fa-check"></i><b>21.1</b> Introduction</a><ul>
<li class="chapter" data-level="21.1.1" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html#understanding-data"><i class="fa fa-check"></i><b>21.1.1</b> Understanding data</a></li>
<li class="chapter" data-level="21.1.2" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html#checking-assumptions"><i class="fa fa-check"></i><b>21.1.2</b> Checking assumptions</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html#regres-diagnose"><i class="fa fa-check"></i><b>21.2</b> Diagnostics for simple linear regression</a><ul>
<li class="chapter" data-level="21.2.1" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html#a-simple-linear-regression-example"><i class="fa fa-check"></i><b>21.2.1</b> A simple linear regression example</a></li>
<li class="chapter" data-level="21.2.2" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html#simple-checks"><i class="fa fa-check"></i><b>21.2.2</b> Simple checks</a></li>
<li class="chapter" data-level="21.2.3" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html#fitted-values"><i class="fa fa-check"></i><b>21.2.3</b> Fitted values</a></li>
<li class="chapter" data-level="21.2.4" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html#checking-the-linearity-assumption"><i class="fa fa-check"></i><b>21.2.4</b> Checking the linearity assumption</a></li>
<li class="chapter" data-level="21.2.5" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html#checking-the-normality-assumption"><i class="fa fa-check"></i><b>21.2.5</b> Checking the normality assumption</a></li>
<li class="chapter" data-level="21.2.6" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html#checking-the-constant-variance-assumption"><i class="fa fa-check"></i><b>21.2.6</b> Checking the constant variance assumption</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html#regression-diagnostics-the-easy-way"><i class="fa fa-check"></i><b>21.3</b> Regression diagnostics the easy way</a></li>
<li class="chapter" data-level="21.4" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html#other-diagnose"><i class="fa fa-check"></i><b>21.4</b> Diagnostics for other kinds of models</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>22</b> Correlation</a><ul>
<li class="chapter" data-level="22.1" data-path="correlation.html"><a href="correlation.html#introduction-4"><i class="fa fa-check"></i><b>22.1</b> Introduction</a></li>
<li class="chapter" data-level="22.2" data-path="correlation.html"><a href="correlation.html#correlation-and-regression"><i class="fa fa-check"></i><b>22.2</b> Correlation and regression</a></li>
<li class="chapter" data-level="22.3" data-path="correlation.html"><a href="correlation.html#pearsons-product-moment-correlation-coefficient"><i class="fa fa-check"></i><b>22.3</b> Pearson’s product-moment correlation coefficient</a><ul>
<li class="chapter" data-level="22.3.1" data-path="correlation.html"><a href="correlation.html#pearsons-product-moment-correlation-coefficient-in-r"><i class="fa fa-check"></i><b>22.3.1</b> Pearson’s product-moment correlation coefficient in R</a></li>
<li class="chapter" data-level="22.3.2" data-path="correlation.html"><a href="correlation.html#reporting-the-result"><i class="fa fa-check"></i><b>22.3.2</b> Reporting the result</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="correlation.html"><a href="correlation.html#spearmans-rank-correlation"><i class="fa fa-check"></i><b>22.4</b> Spearman’s rank correlation</a><ul>
<li class="chapter" data-level="22.4.1" data-path="correlation.html"><a href="correlation.html#spearmans-rank-correlation-coefficient-in-r"><i class="fa fa-check"></i><b>22.4.1</b> Spearman’s rank correlation coefficient in R</a></li>
<li class="chapter" data-level="22.4.2" data-path="correlation.html"><a href="correlation.html#reporting-the-result-1"><i class="fa fa-check"></i><b>22.4.2</b> Reporting the result</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Experimental Design and ANOVA (I)</b></span></li>
<li class="chapter" data-level="23" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html"><i class="fa fa-check"></i><b>23</b> Principles of experimental design</a><ul>
<li class="chapter" data-level="23.1" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#introduction-5"><i class="fa fa-check"></i><b>23.1</b> Introduction</a></li>
<li class="chapter" data-level="23.2" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#jargon-busting"><i class="fa fa-check"></i><b>23.2</b> Jargon busting</a></li>
<li class="chapter" data-level="23.3" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#replication"><i class="fa fa-check"></i><b>23.3</b> Replication</a><ul>
<li class="chapter" data-level="23.3.1" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#independence"><i class="fa fa-check"></i><b>23.3.1</b> Independence and pseudoreplication</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#controls"><i class="fa fa-check"></i><b>23.4</b> Controls</a></li>
<li class="chapter" data-level="23.5" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#confounded-and-noisy-experiments"><i class="fa fa-check"></i><b>23.5</b> Confounded and noisy experiments</a><ul>
<li class="chapter" data-level="23.5.1" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#confounding"><i class="fa fa-check"></i><b>23.5.1</b> Confounding</a></li>
<li class="chapter" data-level="23.5.2" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#noise"><i class="fa fa-check"></i><b>23.5.2</b> Noise</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#dealing-with-confounding-effects-and-noise"><i class="fa fa-check"></i><b>23.6</b> Dealing with confounding effects and noise</a><ul>
<li class="chapter" data-level="23.6.1" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#randomisation"><i class="fa fa-check"></i><b>23.6.1</b> Randomisation</a></li>
<li class="chapter" data-level="23.6.2" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#blocking"><i class="fa fa-check"></i><b>23.6.2</b> Blocking</a></li>
<li class="chapter" data-level="23.6.3" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#experimental-control"><i class="fa fa-check"></i><b>23.6.3</b> Experimental control</a></li>
<li class="chapter" data-level="23.6.4" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#additional-treatments-designing-in-unwanted-variation"><i class="fa fa-check"></i><b>23.6.4</b> Additional treatments: ‘designing in’ unwanted variation</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html#ethics-and-practicality"><i class="fa fa-check"></i><b>23.7</b> Ethics and practicality</a></li>
<li class="chapter" data-level="23.8" data-path="the-scientific-process.html"><a href="the-scientific-process.html#further-reading"><i class="fa fa-check"></i><b>23.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="introduction-to-one-way-anova.html"><a href="introduction-to-one-way-anova.html"><i class="fa fa-check"></i><b>24</b> Introduction to one-way ANOVA</a><ul>
<li class="chapter" data-level="24.1" data-path="introduction-to-one-way-anova.html"><a href="introduction-to-one-way-anova.html#intro"><i class="fa fa-check"></i><b>24.1</b> Introduction</a></li>
<li class="chapter" data-level="24.2" data-path="introduction-to-one-way-anova.html"><a href="introduction-to-one-way-anova.html#why-do-we-need-anova-models"><i class="fa fa-check"></i><b>24.2</b> Why do we need ANOVA models?</a></li>
<li class="chapter" data-level="24.3" data-path="introduction-to-one-way-anova.html"><a href="introduction-to-one-way-anova.html#how-does-anova-work"><i class="fa fa-check"></i><b>24.3</b> How does ANOVA work?</a><ul>
<li class="chapter" data-level="24.3.1" data-path="introduction-to-one-way-anova.html"><a href="introduction-to-one-way-anova.html#degrees-of-freedom"><i class="fa fa-check"></i><b>24.3.1</b> Degrees of freedom</a></li>
<li class="chapter" data-level="24.3.2" data-path="introduction-to-one-way-anova.html"><a href="introduction-to-one-way-anova.html#mean-squares-variance-ratios-and-f-tests"><i class="fa fa-check"></i><b>24.3.2</b> Mean squares, variance ratios, and F-tests</a></li>
<li class="chapter" data-level="24.3.3" data-path="introduction-to-one-way-anova.html"><a href="introduction-to-one-way-anova.html#assumptions-of-anova"><i class="fa fa-check"></i><b>24.3.3</b> Assumptions of ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="introduction-to-one-way-anova.html"><a href="introduction-to-one-way-anova.html#different-kinds-of-anova-model"><i class="fa fa-check"></i><b>24.4</b> Different kinds of ANOVA model</a></li>
<li class="chapter" data-level="24.5" data-path="introduction-to-one-way-anova.html"><a href="introduction-to-one-way-anova.html#questions"><i class="fa fa-check"></i><b>24.5</b> Some common questions about ANOVA</a><ul>
<li class="chapter" data-level="24.5.1" data-path="introduction-to-one-way-anova.html"><a href="introduction-to-one-way-anova.html#can-anova-only-be-applied-to-experimental-data"><i class="fa fa-check"></i><b>24.5.1</b> Can ANOVA only be applied to experimental data?</a></li>
<li class="chapter" data-level="24.5.2" data-path="introduction-to-one-way-anova.html"><a href="introduction-to-one-way-anova.html#do-we-need-equal-replication"><i class="fa fa-check"></i><b>24.5.2</b> Do we need equal replication?</a></li>
<li class="chapter" data-level="24.5.3" data-path="introduction-to-one-way-anova.html"><a href="introduction-to-one-way-anova.html#can-anova-be-done-with-only-two-treatments"><i class="fa fa-check"></i><b>24.5.3</b> Can ANOVA be done with only two treatments?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="one-way-anova-in-r.html"><a href="one-way-anova-in-r.html"><i class="fa fa-check"></i><b>25</b> One-way ANOVA in R</a><ul>
<li class="chapter" data-level="25.1" data-path="one-way-anova-in-r.html"><a href="one-way-anova-in-r.html#introduction-6"><i class="fa fa-check"></i><b>25.1</b> Introduction</a></li>
<li class="chapter" data-level="25.2" data-path="one-way-anova-in-r.html"><a href="one-way-anova-in-r.html#factors-in-r"><i class="fa fa-check"></i><b>25.2</b> Factors in R</a></li>
<li class="chapter" data-level="25.3" data-path="one-way-anova-in-r.html"><a href="one-way-anova-in-r.html#roughly-checking-the-assumptions"><i class="fa fa-check"></i><b>25.3</b> Roughly checking the assumptions</a></li>
<li class="chapter" data-level="25.4" data-path="one-way-anova-in-r.html"><a href="one-way-anova-in-r.html#fitting-the-anova-model"><i class="fa fa-check"></i><b>25.4</b> Fitting the ANOVA model</a></li>
<li class="chapter" data-level="25.5" data-path="one-way-anova-in-r.html"><a href="one-way-anova-in-r.html#diagnostics"><i class="fa fa-check"></i><b>25.5</b> Diagnostics</a><ul>
<li class="chapter" data-level="25.5.1" data-path="one-way-anova-in-r.html"><a href="one-way-anova-in-r.html#aside-formal-test-of-equality-of-variance"><i class="fa fa-check"></i><b>25.5.1</b> Aside: formal test of equality of variance</a></li>
</ul></li>
<li class="chapter" data-level="25.6" data-path="one-way-anova-in-r.html"><a href="one-way-anova-in-r.html#interpreting-the-results"><i class="fa fa-check"></i><b>25.6</b> Interpreting the results</a></li>
<li class="chapter" data-level="25.7" data-path="one-way-anova-in-r.html"><a href="one-way-anova-in-r.html#summarise-results"><i class="fa fa-check"></i><b>25.7</b> Summarising and presenting the results of ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="multiple-comparison-tests.html"><a href="multiple-comparison-tests.html"><i class="fa fa-check"></i><b>26</b> Multiple comparison tests</a><ul>
<li class="chapter" data-level="26.1" data-path="multiple-comparison-tests.html"><a href="multiple-comparison-tests.html#introduction-7"><i class="fa fa-check"></i><b>26.1</b> Introduction</a></li>
<li class="chapter" data-level="26.2" data-path="multiple-comparison-tests.html"><a href="multiple-comparison-tests.html#mult-comp-R"><i class="fa fa-check"></i><b>26.2</b> Tukey’s HSD in R</a></li>
<li class="chapter" data-level="26.3" data-path="multiple-comparison-tests.html"><a href="multiple-comparison-tests.html#how-to-summarise-multiple-comparison-results"><i class="fa fa-check"></i><b>26.3</b> How to summarise multiple-comparison results</a></li>
<li class="chapter" data-level="26.4" data-path="multiple-comparison-tests.html"><a href="multiple-comparison-tests.html#doing-it-the-easy-way"><i class="fa fa-check"></i><b>26.4</b> Doing it the easy way…</a></li>
<li class="chapter" data-level="26.5" data-path="multiple-comparison-tests.html"><a href="multiple-comparison-tests.html#summarise"><i class="fa fa-check"></i><b>26.5</b> Summarising and presenting the results of a Tukey test</a></li>
<li class="chapter" data-level="26.6" data-path="multiple-comparison-tests.html"><a href="multiple-comparison-tests.html#significant-anova-but-no-differences-in-a-tukey-test"><i class="fa fa-check"></i><b>26.6</b> Significant ANOVA but no differences in a Tukey test?</a></li>
</ul></li>
<li class="part"><span><b>Experimental Design and ANOVA (II)</b></span></li>
<li class="chapter" data-level="27" data-path="introduction-to-two-way-anova.html"><a href="introduction-to-two-way-anova.html"><i class="fa fa-check"></i><b>27</b> Introduction to two-way ANOVA</a><ul>
<li class="chapter" data-level="27.1" data-path="parametric-statistics.html"><a href="parametric-statistics.html#introduction"><i class="fa fa-check"></i><b>27.1</b> Introduction</a></li>
<li class="chapter" data-level="27.2" data-path="introduction-to-two-way-anova.html"><a href="introduction-to-two-way-anova.html#degrees-of-freedom-mean-squares-and-f-statistics"><i class="fa fa-check"></i><b>27.2</b> Degrees of freedom, mean squares, and <em>F</em>-statistics</a></li>
<li class="chapter" data-level="27.3" data-path="introduction-to-two-way-anova.html"><a href="introduction-to-two-way-anova.html#multiple-comparison-tests-1"><i class="fa fa-check"></i><b>27.3</b> Multiple comparison tests</a></li>
<li class="chapter" data-level="27.4" data-path="introduction-to-two-way-anova.html"><a href="introduction-to-two-way-anova.html#beyond-two-way-anova"><i class="fa fa-check"></i><b>27.4</b> Beyond two-way ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="two-way-anova-in-r.html"><a href="two-way-anova-in-r.html"><i class="fa fa-check"></i><b>28</b> Two-way ANOVA in R</a><ul>
<li class="chapter" data-level="28.1" data-path="two-way-anova-in-r.html"><a href="two-way-anova-in-r.html#introduction-8"><i class="fa fa-check"></i><b>28.1</b> Introduction</a></li>
<li class="chapter" data-level="28.2" data-path="two-way-anova-in-r.html"><a href="two-way-anova-in-r.html#competition-between-calluna-and-festuca"><i class="fa fa-check"></i><b>28.2</b> Competition between <em>Calluna</em> and <em>Festuca</em></a></li>
<li class="chapter" data-level="28.3" data-path="two-way-anova-in-r.html"><a href="two-way-anova-in-r.html#visualising-the-data-1"><i class="fa fa-check"></i><b>28.3</b> Visualising the data</a></li>
<li class="chapter" data-level="28.4" data-path="two-way-anova-in-r.html"><a href="two-way-anova-in-r.html#fitting-the-anova-model-and-interpreting-the-results"><i class="fa fa-check"></i><b>28.4</b> Fitting the ANOVA model and interpreting the results</a></li>
<li class="chapter" data-level="28.5" data-path="two-way-anova-in-r.html"><a href="two-way-anova-in-r.html#diagnostics-1"><i class="fa fa-check"></i><b>28.5</b> Diagnostics</a></li>
<li class="chapter" data-level="28.6" data-path="two-way-anova-in-r.html"><a href="two-way-anova-in-r.html#interpreting-the-results-1"><i class="fa fa-check"></i><b>28.6</b> Interpreting the results</a><ul>
<li class="chapter" data-level="28.6.1" data-path="two-way-anova-in-r.html"><a href="two-way-anova-in-r.html#understanding-the-model-graphically"><i class="fa fa-check"></i><b>28.6.1</b> Understanding the model graphically</a></li>
</ul></li>
<li class="chapter" data-level="28.7" data-path="two-way-anova-in-r.html"><a href="two-way-anova-in-r.html#multiple-comparison-tests-2"><i class="fa fa-check"></i><b>28.7</b> Multiple comparison tests</a></li>
<li class="chapter" data-level="28.8" data-path="two-way-anova-in-r.html"><a href="two-way-anova-in-r.html#drawing-conclusions-and-presenting-results"><i class="fa fa-check"></i><b>28.8</b> Drawing conclusions and presenting results</a><ul>
<li class="chapter" data-level="28.8.1" data-path="two-way-anova-in-r.html"><a href="two-way-anova-in-r.html#a-little-more-customisation"><i class="fa fa-check"></i><b>28.8.1</b> A little more customisation</a></li>
</ul></li>
<li class="chapter" data-level="28.9" data-path="two-way-anova-in-r.html"><a href="two-way-anova-in-r.html#balanced-or-orthogonal-designs"><i class="fa fa-check"></i><b>28.9</b> Balanced or orthogonal designs</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="anova-for-randomised-block-designs.html"><a href="anova-for-randomised-block-designs.html"><i class="fa fa-check"></i><b>29</b> ANOVA for randomised block designs</a><ul>
<li class="chapter" data-level="29.1" data-path="anova-for-randomised-block-designs.html"><a href="anova-for-randomised-block-designs.html#randomized-complete-block-designs"><i class="fa fa-check"></i><b>29.1</b> Randomized Complete Block Designs</a></li>
<li class="chapter" data-level="29.2" data-path="anova-for-randomised-block-designs.html"><a href="anova-for-randomised-block-designs.html#designs-without-replication"><i class="fa fa-check"></i><b>29.2</b> Designs without replication</a></li>
<li class="chapter" data-level="29.3" data-path="anova-for-randomised-block-designs.html"><a href="anova-for-randomised-block-designs.html#analysing-an-rcbd-experiment"><i class="fa fa-check"></i><b>29.3</b> Analysing an RCBD experiment</a></li>
<li class="chapter" data-level="29.4" data-path="anova-for-randomised-block-designs.html"><a href="anova-for-randomised-block-designs.html#carrying-out-the-analysis-with-r"><i class="fa fa-check"></i><b>29.4</b> Carrying out the analysis with R</a><ul>
<li class="chapter" data-level="29.4.1" data-path="anova-for-randomised-block-designs.html"><a href="anova-for-randomised-block-designs.html#multiple-comparisons-anyone"><i class="fa fa-check"></i><b>29.4.1</b> Multiple comparisons anyone?</a></li>
</ul></li>
<li class="chapter" data-level="29.5" data-path="anova-for-randomised-block-designs.html"><a href="anova-for-randomised-block-designs.html#are-there-disadvantages-to-randomised-block-designs"><i class="fa fa-check"></i><b>29.5</b> Are there disadvantages to randomised block designs?</a></li>
<li class="chapter" data-level="29.6" data-path="anova-for-randomised-block-designs.html"><a href="anova-for-randomised-block-designs.html#multiple-blocking-factors"><i class="fa fa-check"></i><b>29.6</b> Multiple blocking factors</a></li>
</ul></li>
<li class="part"><span><b>Fixing Problems</b></span></li>
<li class="chapter" data-level="30" data-path="data-transformations.html"><a href="data-transformations.html"><i class="fa fa-check"></i><b>30</b> Data transformations</a><ul>
<li class="chapter" data-level="30.1" data-path="data-transformations.html"><a href="data-transformations.html#transforms-introduction"><i class="fa fa-check"></i><b>30.1</b> Data that violate ANOVA assumptions</a></li>
<li class="chapter" data-level="30.2" data-path="data-transformations.html"><a href="data-transformations.html#ant-eg"><i class="fa fa-check"></i><b>30.2</b> Data transformation: ANOVAs and <em>t</em>-tests</a><ul>
<li class="chapter" data-level="30.2.1" data-path="data-transformations.html"><a href="data-transformations.html#the-data-foraging-in-ants"><i class="fa fa-check"></i><b>30.2.1</b> The data: foraging in ants</a></li>
<li class="chapter" data-level="30.2.2" data-path="data-transformations.html"><a href="data-transformations.html#fit-the-model-and-checking-the-assumptions"><i class="fa fa-check"></i><b>30.2.2</b> Fit the model and checking the assumptions</a></li>
</ul></li>
<li class="chapter" data-level="30.3" data-path="data-transformations.html"><a href="data-transformations.html#carry-on"><i class="fa fa-check"></i><b>30.3</b> Carrying on anyway</a></li>
<li class="chapter" data-level="30.4" data-path="data-transformations.html"><a href="data-transformations.html#transform"><i class="fa fa-check"></i><b>30.4</b> Transforming the data</a><ul>
<li class="chapter" data-level="30.4.1" data-path="data-transformations.html"><a href="data-transformations.html#the-logarithmic-transformation"><i class="fa fa-check"></i><b>30.4.1</b> The logarithmic transformation</a></li>
<li class="chapter" data-level="30.4.2" data-path="data-transformations.html"><a href="data-transformations.html#presenting-results-from-analyses-of-transformed-data"><i class="fa fa-check"></i><b>30.4.2</b> Presenting results from analyses of transformed data</a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="data-transformations.html"><a href="data-transformations.html#trans-types"><i class="fa fa-check"></i><b>30.5</b> Types of transformations</a><ul>
<li class="chapter" data-level="30.5.1" data-path="data-transformations.html"><a href="data-transformations.html#logarithms"><i class="fa fa-check"></i><b>30.5.1</b> Logarithms</a></li>
<li class="chapter" data-level="30.5.2" data-path="data-transformations.html"><a href="data-transformations.html#square-roots"><i class="fa fa-check"></i><b>30.5.2</b> Square roots</a></li>
<li class="chapter" data-level="30.5.3" data-path="data-transformations.html"><a href="data-transformations.html#arcsine-square-root"><i class="fa fa-check"></i><b>30.5.3</b> Arcsine square root</a></li>
<li class="chapter" data-level="30.5.4" data-path="data-transformations.html"><a href="data-transformations.html#squaring"><i class="fa fa-check"></i><b>30.5.4</b> Squaring</a></li>
<li class="chapter" data-level="30.5.5" data-path="data-transformations.html"><a href="data-transformations.html#situations-which-cannot-be-dealt-with-by-transformations"><i class="fa fa-check"></i><b>30.5.5</b> Situations which cannot be dealt with by transformations</a></li>
</ul></li>
<li class="chapter" data-level="30.6" data-path="data-transformations.html"><a href="data-transformations.html#what-about-other-kinds-of-models"><i class="fa fa-check"></i><b>30.6</b> What about other kinds of models?</a></li>
<li class="chapter" data-level="30.7" data-path="data-transformations.html"><a href="data-transformations.html#final-thoughts"><i class="fa fa-check"></i><b>30.7</b> Final thoughts</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html"><i class="fa fa-check"></i><b>31</b> Non-parametric tests</a><ul>
<li class="chapter" data-level="31.1" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#what-is-non-par"><i class="fa fa-check"></i><b>31.1</b> What is a non-parametric test?</a></li>
<li class="chapter" data-level="31.2" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#non-par-intro"><i class="fa fa-check"></i><b>31.2</b> How does a non-parametric test work?</a></li>
<li class="chapter" data-level="31.3" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#non-parametric-equivalents-to-t-tests-and-anova"><i class="fa fa-check"></i><b>31.3</b> Non-parametric equivalents to <em>t</em>-tests and ANOVA</a></li>
<li class="chapter" data-level="31.4" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>31.4</b> Wilcoxon signed-rank test</a><ul>
<li class="chapter" data-level="31.4.1" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#leaf-damage-plant-defences-and-feeding-by-winter-moth-larvae"><i class="fa fa-check"></i><b>31.4.1</b> Leaf damage, plant defences and feeding by winter moth larvae</a></li>
</ul></li>
<li class="chapter" data-level="31.5" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#mann-whitney"><i class="fa fa-check"></i><b>31.5</b> The Mann-Whitney <em>U</em>-test</a><ul>
<li class="chapter" data-level="31.5.1" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#ant-foraging"><i class="fa fa-check"></i><b>31.5.1</b> Ant foraging</a></li>
</ul></li>
<li class="chapter" data-level="31.6" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#the-kruskal-wallis-test"><i class="fa fa-check"></i><b>31.6</b> The Kruskal-Wallis test</a><ul>
<li class="chapter" data-level="31.6.1" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#learning-in-cuttlefish"><i class="fa fa-check"></i><b>31.6.1</b> Learning in cuttlefish</a></li>
</ul></li>
<li class="chapter" data-level="31.7" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#why-when"><i class="fa fa-check"></i><b>31.7</b> Why use non-parametric tests … and when?</a><ul>
<li class="chapter" data-level="31.7.1" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#what-are-the-advantages"><i class="fa fa-check"></i><b>31.7.1</b> What are the advantages?</a></li>
<li class="chapter" data-level="31.7.2" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#what-are-the-disadvantages"><i class="fa fa-check"></i><b>31.7.2</b> What are the disadvantages?</a></li>
<li class="chapter" data-level="31.7.3" data-path="non-parametric-tests.html"><a href="non-parametric-tests.html#parting-words"><i class="fa fa-check"></i><b>31.7.3</b> Parting words</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Supplementary Material</b></span></li>
<li class="chapter" data-level="A" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>A</b> Exercises</a><ul>
<li class="chapter" data-level="A.1" data-path="exercises.html"><a href="exercises.html#week-2"><i class="fa fa-check"></i><b>A.1</b> Week 2</a><ul>
<li class="chapter" data-level="A.1.1" data-path="exercises.html"><a href="exercises.html#what-kind-of-variable-is-it"><i class="fa fa-check"></i><b>A.1.1</b> What kind of variable is it?</a></li>
<li class="chapter" data-level="A.1.2" data-path="exercises.html"><a href="exercises.html#definitions"><i class="fa fa-check"></i><b>A.1.2</b> Definitions</a></li>
<li class="chapter" data-level="A.1.3" data-path="exercises.html"><a href="exercises.html#what-form-do-sampling-distributions-take"><i class="fa fa-check"></i><b>A.1.3</b> What form do sampling distributions take?</a></li>
<li class="chapter" data-level="A.1.4" data-path="exercises.html"><a href="exercises.html#how-does-sample-size-influence-the-standard-error"><i class="fa fa-check"></i><b>A.1.4</b> How does sample size influence the standard error?</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="exercises.html"><a href="exercises.html#week-3"><i class="fa fa-check"></i><b>A.2</b> Week 3</a><ul>
<li class="chapter" data-level="A.2.1" data-path="exercises.html"><a href="exercises.html#sample-size-and-statistical-power"><i class="fa fa-check"></i><b>A.2.1</b> Sample size and statistical power</a></li>
<li class="chapter" data-level="A.2.2" data-path="exercises.html"><a href="exercises.html#a-bit-more-about-statistical-power"><i class="fa fa-check"></i><b>A.2.2</b> A bit more about statistical power</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="exercises.html"><a href="exercises.html#week-4"><i class="fa fa-check"></i><b>A.3</b> Week 4</a><ul>
<li class="chapter" data-level="A.3.1" data-path="exercises.html"><a href="exercises.html#eagle-owls-and-norway-rats"><i class="fa fa-check"></i><b>A.3.1</b> Eagle owls and Norway rats</a></li>
<li class="chapter" data-level="A.3.2" data-path="exercises.html"><a href="exercises.html#the-power-of-pairing"><i class="fa fa-check"></i><b>A.3.2</b> The power of pairing</a></li>
<li class="chapter" data-level="A.3.3" data-path="exercises.html"><a href="exercises.html#fungal-infection-in-french-beans"><i class="fa fa-check"></i><b>A.3.3</b> Fungal infection in French beans</a></li>
<li class="chapter" data-level="A.3.4" data-path="exercises.html"><a href="exercises.html#sheep-grass"><i class="fa fa-check"></i><b>A.3.4</b> Sheep, grass and nature reserves</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="exercises.html"><a href="exercises.html#week-5"><i class="fa fa-check"></i><b>A.4</b> Week 5</a><ul>
<li class="chapter" data-level="A.4.1" data-path="exercises.html"><a href="exercises.html#oviposition-behaviour-in-bean-weevils"><i class="fa fa-check"></i><b>A.4.1</b> Oviposition behaviour in bean weevils</a></li>
<li class="chapter" data-level="A.4.2" data-path="exercises.html"><a href="exercises.html#determining-expected-values"><i class="fa fa-check"></i><b>A.4.2</b> Determining expected values</a></li>
<li class="chapter" data-level="A.4.3" data-path="exercises.html"><a href="exercises.html#sex-and-eye-colour"><i class="fa fa-check"></i><b>A.4.3</b> Sex and eye colour</a></li>
<li class="chapter" data-level="A.4.4" data-path="exercises.html"><a href="exercises.html#eagle-owls-and-prey-choice"><i class="fa fa-check"></i><b>A.4.4</b> Eagle owls and prey choice</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="exercises.html"><a href="exercises.html#week-6"><i class="fa fa-check"></i><b>A.5</b> Week 6</a><ul>
<li class="chapter" data-level="A.5.1" data-path="exercises.html"><a href="exercises.html#hedgerows-and-partridges"><i class="fa fa-check"></i><b>A.5.1</b> Hedgerows and partridges</a></li>
<li class="chapter" data-level="A.5.2" data-path="exercises.html"><a href="exercises.html#analysing-associations"><i class="fa fa-check"></i><b>A.5.2</b> Analysing associations</a></li>
<li class="chapter" data-level="A.5.3" data-path="exercises.html"><a href="exercises.html#diagnosing-problems"><i class="fa fa-check"></i><b>A.5.3</b> Diagnosing problems</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="exercises.html"><a href="exercises.html#week-7"><i class="fa fa-check"></i><b>A.6</b> Week 7</a><ul>
<li class="chapter" data-level="A.6.1" data-path="exercises.html"><a href="exercises.html#lead-pollution-in-lakes"><i class="fa fa-check"></i><b>A.6.1</b> Lead pollution in lakes</a></li>
<li class="chapter" data-level="A.6.2" data-path="exercises.html"><a href="exercises.html#the-effect-of-molluscicide-on-rates-of-movement-in-slugs"><i class="fa fa-check"></i><b>A.6.2</b> The effect of molluscicide on rates of movement in slugs</a></li>
<li class="chapter" data-level="A.6.3" data-path="exercises.html"><a href="exercises.html#multiple-comparisons-slug-movement-and-molluscicide"><i class="fa fa-check"></i><b>A.6.3</b> Multiple comparisons — slug movement and molluscicide</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="exercises.html"><a href="exercises.html#week-8"><i class="fa fa-check"></i><b>A.7</b> Week 8</a><ul>
<li class="chapter" data-level="A.7.1" data-path="exercises.html"><a href="exercises.html#limpets-and-salinity"><i class="fa fa-check"></i><b>A.7.1</b> Limpets and salinity</a></li>
<li class="chapter" data-level="A.7.2" data-path="exercises.html"><a href="exercises.html#sheep-grass-and-nature-reserves-again"><i class="fa fa-check"></i><b>A.7.2</b> Sheep, grass and nature reserves (again)</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="exercises.html"><a href="exercises.html#week-9"><i class="fa fa-check"></i><b>A.8</b> Week 9</a><ul>
<li class="chapter" data-level="A.8.1" data-path="exercises.html"><a href="exercises.html#fungal-pathogen-infection-on-leaves"><i class="fa fa-check"></i><b>A.8.1</b> Fungal pathogen infection on leaves</a></li>
<li class="chapter" data-level="A.8.2" data-path="exercises.html"><a href="exercises.html#pollution-sensitive-stoneflies---whats-going-into-the-river"><i class="fa fa-check"></i><b>A.8.2</b> Pollution sensitive stoneflies - what’s going into the river?</a></li>
<li class="chapter" data-level="A.8.3" data-path="exercises.html"><a href="exercises.html#ants-again"><i class="fa fa-check"></i><b>A.8.3</b> Ants again</a></li>
<li class="chapter" data-level="A.8.4" data-path="exercises.html"><a href="exercises.html#bryophyte-diversity-in-a-woodland"><i class="fa fa-check"></i><b>A.8.4</b> Bryophyte diversity in a woodland</a></li>
<li class="chapter" data-level="A.8.5" data-path="exercises.html"><a href="exercises.html#reporting-the-results-of-non-parametric-tests"><i class="fa fa-check"></i><b>A.8.5</b> Reporting the results of non-parametric tests</a></li>
<li class="chapter" data-level="A.8.6" data-path="exercises.html"><a href="exercises.html#copper-tolerance-in-agrostis"><i class="fa fa-check"></i><b>A.8.6</b> Copper tolerance in <em>Agrostis</em></a></li>
<li class="chapter" data-level="A.8.7" data-path="exercises.html"><a href="exercises.html#measuring-seed-dispersal"><i class="fa fa-check"></i><b>A.8.7</b> Measuring seed dispersal</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="choosing-models-and-tests.html"><a href="choosing-models-and-tests.html"><i class="fa fa-check"></i><b>B</b> Choosing models and tests</a><ul>
<li class="chapter" data-level="B.1" data-path="introduction-to-one-way-anova.html"><a href="introduction-to-one-way-anova.html#intro"><i class="fa fa-check"></i><b>B.1</b> Introduction</a><ul>
<li class="chapter" data-level="B.1.1" data-path="choosing-models-and-tests.html"><a href="choosing-models-and-tests.html#do-we-need-to-carry-out-a-statistical-analysis"><i class="fa fa-check"></i><b>B.1.1</b> Do we need to carry out a statistical analysis?</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="choosing-models-and-tests.html"><a href="choosing-models-and-tests.html#getting-started"><i class="fa fa-check"></i><b>B.2</b> Getting started…</a></li>
<li class="chapter" data-level="B.3" data-path="choosing-models-and-tests.html"><a href="choosing-models-and-tests.html#a-key-to-choosing-statistical-models-and-tests"><i class="fa fa-check"></i><b>B.3</b> A key to choosing statistical models and tests</a></li>
<li class="chapter" data-level="B.4" data-path="choosing-models-and-tests.html"><a href="choosing-models-and-tests.html#four-questions"><i class="fa fa-check"></i><b>B.4</b> Four main types of question</a></li>
<li class="chapter" data-level="B.5" data-path="choosing-models-and-tests.html"><a href="choosing-models-and-tests.html#qu1"><i class="fa fa-check"></i><b>B.5</b> Question 1 –- Comparison of group means or medians</a><ul>
<li class="chapter" data-level="B.5.1" data-path="choosing-models-and-tests.html"><a href="choosing-models-and-tests.html#question-1-how-many-groups"><i class="fa fa-check"></i><b>B.5.1</b> Question 1 How many groups?</a></li>
<li class="chapter" data-level="B.5.2" data-path="choosing-models-and-tests.html"><a href="choosing-models-and-tests.html#question-1-single-group"><i class="fa fa-check"></i><b>B.5.2</b> [Question 1] Single group</a></li>
<li class="chapter" data-level="B.5.3" data-path="choosing-models-and-tests.html"><a href="choosing-models-and-tests.html#question-1-two-groups"><i class="fa fa-check"></i><b>B.5.3</b> [Question 1] Two groups</a></li>
<li class="chapter" data-level="B.5.4" data-path="choosing-models-and-tests.html"><a href="choosing-models-and-tests.html#question-1-more-than-two-groups"><i class="fa fa-check"></i><b>B.5.4</b> [Question 1] More than two groups</a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="choosing-models-and-tests.html"><a href="choosing-models-and-tests.html#qu2"><i class="fa fa-check"></i><b>B.6</b> Question 2 – Associations between two variables?</a><ul>
<li class="chapter" data-level="B.6.1" data-path="choosing-models-and-tests.html"><a href="choosing-models-and-tests.html#question-2-testing-y-as-a-function-of-x-or-an-association-between-x-and-y"><i class="fa fa-check"></i><b>B.6.1</b> [Question 2] Testing <span class="math inline">\(y\)</span> as a function of <span class="math inline">\(x\)</span>, or an association between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>?</a></li>
</ul></li>
<li class="chapter" data-level="B.7" data-path="choosing-models-and-tests.html"><a href="choosing-models-and-tests.html#qu4"><i class="fa fa-check"></i><b>B.7</b> Question 3 -– Frequencies of categorical data</a></li>
<li class="chapter" data-level="B.8" data-path="choosing-models-and-tests.html"><a href="choosing-models-and-tests.html#var-cat"><i class="fa fa-check"></i><b>B.8</b> Variables or categories?</a><ul>
<li class="chapter" data-level="B.8.1" data-path="choosing-models-and-tests.html"><a href="choosing-models-and-tests.html#anova-vs.regression"><i class="fa fa-check"></i><b>B.8.1</b> ANOVA vs. regression</a></li>
<li class="chapter" data-level="B.8.2" data-path="choosing-models-and-tests.html"><a href="choosing-models-and-tests.html#making-categories-out-of-continuous-measures"><i class="fa fa-check"></i><b>B.8.2</b> Making categories out of continuous measures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="writing-a-scientific-report.html"><a href="writing-a-scientific-report.html"><i class="fa fa-check"></i><b>C</b> Writing a scientific report</a><ul>
<li class="chapter" data-level="C.1" data-path="writing-a-scientific-report.html"><a href="writing-a-scientific-report.html#introduction-9"><i class="fa fa-check"></i><b>C.1</b> Introduction</a></li>
<li class="chapter" data-level="C.2" data-path="writing-a-scientific-report.html"><a href="writing-a-scientific-report.html#the-structure-of-a-scientific-report"><i class="fa fa-check"></i><b>C.2</b> The structure of a scientific report</a><ul>
<li class="chapter" data-level="C.2.1" data-path="writing-a-scientific-report.html"><a href="writing-a-scientific-report.html#title"><i class="fa fa-check"></i><b>C.2.1</b> Title</a></li>
<li class="chapter" data-level="C.2.2" data-path="writing-a-scientific-report.html"><a href="writing-a-scientific-report.html#abstract-or-summary"><i class="fa fa-check"></i><b>C.2.2</b> Abstract or Summary</a></li>
<li class="chapter" data-level="C.2.3" data-path="writing-a-scientific-report.html"><a href="writing-a-scientific-report.html#introduction-10"><i class="fa fa-check"></i><b>C.2.3</b> Introduction</a></li>
<li class="chapter" data-level="C.2.4" data-path="index.html"><a href="index.html#methods"><i class="fa fa-check"></i><b>C.2.4</b> Methods</a></li>
<li class="chapter" data-level="C.2.5" data-path="writing-a-scientific-report.html"><a href="writing-a-scientific-report.html#results"><i class="fa fa-check"></i><b>C.2.5</b> Results</a></li>
<li class="chapter" data-level="C.2.6" data-path="writing-a-scientific-report.html"><a href="writing-a-scientific-report.html#discussion"><i class="fa fa-check"></i><b>C.2.6</b> Discussion</a></li>
<li class="chapter" data-level="C.2.7" data-path="writing-a-scientific-report.html"><a href="writing-a-scientific-report.html#acknowledgements"><i class="fa fa-check"></i><b>C.2.7</b> Acknowledgements</a></li>
<li class="chapter" data-level="C.2.8" data-path="writing-a-scientific-report.html"><a href="writing-a-scientific-report.html#literature-cited-references"><i class="fa fa-check"></i><b>C.2.8</b> Literature cited / References</a></li>
<li class="chapter" data-level="C.2.9" data-path="writing-a-scientific-report.html"><a href="writing-a-scientific-report.html#appendices"><i class="fa fa-check"></i><b>C.2.9</b> Appendices</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="writing-a-scientific-report.html"><a href="writing-a-scientific-report.html#presenting-species-names"><i class="fa fa-check"></i><b>C.3</b> Presenting species names</a></li>
<li class="chapter" data-level="C.4" data-path="writing-a-scientific-report.html"><a href="writing-a-scientific-report.html#approaches-to-writing"><i class="fa fa-check"></i><b>C.4</b>  Approaches to writing</a><ul>
<li class="chapter" data-level="C.4.1" data-path="writing-a-scientific-report.html"><a href="writing-a-scientific-report.html#a-last-piece-of-advice"><i class="fa fa-check"></i><b>C.4.1</b> A last piece of advice…</a></li>
</ul></li>
<li class="chapter" data-level="C.5" data-path="writing-a-scientific-report.html"><a href="writing-a-scientific-report.html#further-reading-1"><i class="fa fa-check"></i><b>C.5</b> Further reading</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">APS 240: Data Analysis and Statistics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="two-way-anova-in-r" class="section level1">
<h1><span class="header-section-number">Chapter 28</span> Two-way ANOVA in R</h1>
<div id="introduction-8" class="section level2">
<h2><span class="header-section-number">28.1</span> Introduction</h2>
<p>Our goal in this chapter is to learn how to work with two-way ANOVA models in R. As always, we’ll do this by working through an example—using data from a plant competition experiment. The work flow is very similar to one-way ANOVA in R. We’ll start with the problem and the data, and then work through model fitting, evaluating assumptions, significance testing, and finally, presenting the results.</p>
</div>
<div id="competition-between-calluna-and-festuca" class="section level2">
<h2><span class="header-section-number">28.2</span> Competition between <em>Calluna</em> and <em>Festuca</em></h2>
<p>Plants have an optimal soil pH for growth, and this varies between species. Consequently we would expect that if we grow two plants in competition with each other at different pH values the effect of competition might vary according to the soil pH. In a recent study the growth of the grass <em>Festuca ovina</em> (Sheep’s Fescue) in competition with the heather <em>Calluna vulgaris</em> (Ling) was investigated in soils with different pH. <em>Calluna</em> is well adapted to grow on very acidic soils such as on the Millstone grit and blanket bogs around Sheffield. <em>Festuca</em> grows on soils with a much wider range of pH. We might hypothesise that <em>Calluna</em> will be a better competitor of <em>Festuca</em> in very acid soils than in moderately acid soils.</p>
<p>To test this hypothesis an experiment was designed in which Festuca seedlings were grown in pots at all combinations of two levels of two different kinds of treatment:</p>
<p><strong>Factor 1:</strong> Soil pH at 3.5 or 5.5</p>
<p><strong>Factor 2:</strong> Presence or absence of <em>Calluna</em>.</p>
<p>This is a fully factorial, two-way design. The total number of treatments was thus <span class="math inline">\(2 \times 2 = 4\)</span>. For each of the treatments there were 5 replicate pots, giving a total of <span class="math inline">\(2 \times 2 \times 5 = 20\)</span> pots.</p>
<p>The following data are the yields of <em>Festuca</em> from each treatment (dry weight in g) from the two pH levels and in the presence or absence of <em>Calluna</em>.</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">pH 3.5</th>
<th align="center">pH 5.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><em>Calluna</em> Present</td>
<td align="center">2.76, 2.39, 3.54, 3.71, 2.49</td>
<td align="center">3.21, 4.10, 3.04, 4.13, 5.21</td>
</tr>
<tr class="even">
<td align="left"><em>Calluna</em> Absent</td>
<td align="center">4.10, 2.72, 2.28, 4.43, 3.31</td>
<td align="center">5.92, 7.31, 6.10, 5.25, 7.45</td>
</tr>
</tbody>
</table>
<div class="do-something">
<p>
<strong>Walk through</strong>
</p>
<p>
You should begin working through the <em>Festuca</em> example from this point.
</p>
</div>
<p>The data are in a CSV file called FESTUCA.CSV. We’ll read the data into an R data frame, giving it the name <code>festuca</code>, and then print <em>the whole data frame to the Console</em> (<code>View</code> is another option here):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">festuca &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="st">&quot;FESTUCA.CSV&quot;</span>)</code></pre></div>
<pre><code>##    Weight    pH Calluna
## 1    2.76 pH3.5 Present
## 2    2.39 pH3.5 Present
## 3    3.54 pH3.5 Present
## 4    3.71 pH3.5 Present
## 5    2.49 pH3.5 Present
## 6    4.10 pH3.5  Absent
## 7    2.72 pH3.5  Absent
## 8    2.28 pH3.5  Absent
## 9    4.43 pH3.5  Absent
## 10   3.31 pH3.5  Absent
## 11   3.21 pH5.5 Present
## 12   4.10 pH5.5 Present
## 13   3.04 pH5.5 Present
## 14   4.13 pH5.5 Present
## 15   5.21 pH5.5 Present
## 16   5.92 pH5.5  Absent
## 17   7.31 pH5.5  Absent
## 18   6.10 pH5.5  Absent
## 19   5.25 pH5.5  Absent
## 20   7.45 pH5.5  Absent</code></pre>
<p>Notice that the data for a two-factor experiment can be laid out in a very similar manner to those from a one factor experiment, with the actual data in one column, but now there are two additional columns containing the codes for the treatments, one for pH and one for <em>Calluna</em>. The first column (<code>Weight</code>) contains the <em>Festuca</em> dry weights, the second column (<code>pH</code>) contains the codes for the pH treatment (levels: pH3.5, pH5.5), the third column (<code>Calluna</code>) contains the codes for the presence or absence of <em>Calluna</em> (levels: Present, Absent).</p>
<p>A couple of points are worth noting at this point:</p>
<ol style="list-style-type: decimal">
<li><p>As is always the case in this book, the data are ‘tidy’. Each experimental factor is in one column and each observation is in a single row. Last year we pointed out that data need to be in this format to be used effectively with <code>dplyr</code>. The same applies to the majority of R’s statistical modelling tools—they expect data to be supplied in this format.</p></li>
<li><p>We avoided using numbers to encode the levels of the pH treatment. This is important, as it ensures that the <code>pH</code> variable will be converted into a factor rather than a number when we read the data into R. We have said it before, but it is worth saying one more time: fewer mistakes will occur if we use words to encode the levels of a factor.</p></li>
</ol>
</div>
<div id="visualising-the-data-1" class="section level2">
<h2><span class="header-section-number">28.3</span> Visualising the data</h2>
<p>We should take a look at the data before doing anything with it. We only have five replicates per treatment combination, so any figure we produce is going to provide only limited information. Five replicates is just about sufficient for a box plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> festuca, <span class="kw">aes</span>(<span class="dt">x =</span> Calluna, <span class="dt">y =</span> Weight, <span class="dt">colour =</span> pH)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="stats-for-bio_files/figure-html/festuca-boxplot-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>The main purpose of a plot like this is to help us understand what the treatments are doing. We want to quickly assess things like: How big are the main effects? What direction do they work in? Is there likely to be an interaction? It looks like the higher pH conditions tends to increase <em>Festuca</em> growth, and the presence of <em>Calluna</em> tends to reduce it (yes, plants compete!). The more interesting observation is that the effect of <em>Calluna</em> seems to be greater at higher pH. It looks like we might have an interaction.</p>
<p>At this point it may be tempting to start evaluating the assumptions of our model. If we have a large number of replicates then it sometimes makes sense to do this with a box and whiskers plot, or separate dot plots for each treatment combination. We don’t have that many replicates though, and even if we did, it is much better to rely on regression diagnostics. We need to fit the model first to get at these.</p>
</div>
<div id="fitting-the-anova-model-and-interpreting-the-results" class="section level2">
<h2><span class="header-section-number">28.4</span> Fitting the ANOVA model and interpreting the results</h2>
<p>Carrying out a two-way ANOVA in R is really no different from one-way ANOVA. It still involves two steps. First we have to fit the model using the <code>lm</code> function, remembering to store the fitted model object. This is the step where R calculates the relevant means, along with the additional information needed to generate the results in step two. The second step uses the <code>anova</code> function to calculate <em>F</em>-statistics, degrees of freedom, and <em>p</em>-values.</p>
<p>Here is the R code needed to carry out the model-fitting step with <code>lm</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">festuca_model &lt;-<span class="st"> </span><span class="kw">lm</span>(Weight ~<span class="st"> </span>pH +<span class="st"> </span>Calluna +<span class="st"> </span>pH :<span class="st"> </span>Calluna, <span class="dt">data =</span> festuca)</code></pre></div>
<p>This is very similar to the R code used to fit a one-way ANOVA model. The first argument is a formula (notice the ‘tilde’ symbol: <code>~</code>) and the second argument is the name of the data frame that contains all the variables listed in the formula. That’s all we need.</p>
<p>The specific model fitted by <code>lm</code> is a result of 1) the type of variables referenced in the formula, and 2) the symbols used to define the terms in the formula. To ensure that we have fitted an ANOVA model, the variables which appear to the right of the <code>~</code> must be factors or character vectors—an ANOVA only involves factors. The variable name to the left of the <code>~</code> is the numeric variable we are analysing. We know that <code>Calluna</code> and <code>pH</code> are factors, so we can be certain that <code>lm</code> has fitted some kind of ANOVA model.</p>
<p>What kind of ANOVA have we fitted, i.e., what are the terms on the right hand side of the formula doing? Here is the formula we used:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Weight ~<span class="st"> </span>pH +<span class="st"> </span>Calluna +<span class="st"> </span>pH:Calluna</code></pre></div>
<p>There are three terms, each separated by a <code>+</code> symbol: <code>pH</code>, <code>Calluna</code> and <code>pH:Calluna</code>. This tells R that we want to fit a model that accounts for the main effects of <code>pH</code> and <code>Calluna</code>, and that we also wish to include the interaction between these two factors. The specification of the main effects is fairly self-explanatory—we just include the name of each factor variable in the formula. The interaction term is less obvious. It is specified by a colon (the <code>:</code> symbol) with the two interacting variables either side of it.</p>
<p>In summary… 1) the <code>~</code> symbol specifies a formula in R, where the name on the left hand side is the variable we are analysing, and the names on the right denote the terms in the model; 2) we place a <code>+</code> between terms to delineate them (we are not adding anything up when the <code>+</code> is used in a formula); 3) each main effect is specified by the corresponding factor name; and 4) an interaction between factors is specified by the <code>:</code> symbol.</p>
<p>Notice that we assigned the result a name (<code>festuca_model</code>) which now refers to the model object produced by <code>lm</code>. Just as with a one-way ANOVA, we can’t extract <em>p</em>-values by printing this object to the console, because all this gives us is a limited summary of the fitted model’s coefficients:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">festuca_model</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Weight ~ pH + Calluna + pH:Calluna, data = festuca)
## 
## Coefficients:
##            (Intercept)                 pHpH5.5          CallunaPresent  
##                  3.368                   3.038                  -0.390  
## pHpH5.5:CallunaPresent  
##                 -2.078</code></pre>
<p>We’re not going to worry about what those mean for a two-way ANOVA. We’re going to use <code>anova</code> to calculate things like degrees of freedom, sum of squares, mean squares, <em>F</em>-statistics, and finally, the <em>p</em>-values. But… before we do that, let’s check our assumptions now that we have a fitted model object.</p>
</div>
<div id="diagnostics-1" class="section level2">
<h2><span class="header-section-number">28.5</span> Diagnostics</h2>
<p>We’re going to produce two diagnostic plots: a normal probability plot to evaluate the normality assumption, and a scale-location plot allows us to evaluate the constant variance assumption. Here’s the normal probability plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(festuca_model, <span class="dt">which =</span> <span class="dv">2</span>, <span class="dt">add.smooth =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="stats-for-bio_files/figure-html/festuca-diag-2-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>This plot allows us to check whether the deviations from the group means (the residuals) are likely to have been drawn from a normal distribution. This looks… not so great. The points deviate from the line in a systematic way so it looks like the normality assumption may not be satisfied. The left tail is above the line and the right tail is below it. This tells us that the tails of the residual distribution do not extend out as far as they should—the distribution is ‘squashed’ toward its middle.</p>
<p>The scale-location plot allows us to see whether or not the variability of the residuals is roughly constant within each group. Here’s the plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(festuca_model, <span class="dt">which =</span> <span class="dv">3</span>, <span class="dt">add.smooth =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="stats-for-bio_files/figure-html/festuca-diag-3-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>We’re on the lookout for a systematic pattern in the size of the residuals and the fitted values—does the variability go up or down with the fitted values? There is no such pattern so it looks like the constant variance assumption is at least satisfied here.</p>
<p>We’ve identified one potential problem. We’ll ignore it for now and press on. The goal here is to learn the work flow for two-way ANOVA in R. However, keep in mind that if we were serious about the analysis we should find a way to ‘fix’ it. We’re going to learn some useful tricks for doing this in later chapters.</p>
</div>
<div id="interpreting-the-results-1" class="section level2">
<h2><span class="header-section-number">28.6</span> Interpreting the results</h2>
<p>Now we’re ready to calculate the degrees of freedom, sums of squares, mean squares, the <em>F</em>-ratio, and <em>p</em>-values for the main effects and the interaction terms:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(festuca_model)</code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Weight
##            Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## pH          1 19.9800 19.9800 28.1792 7.065e-05 ***
## Calluna     1 10.2102 10.2102 14.4001   0.00159 ** 
## pH:Calluna  1  5.3976  5.3976  7.6126   0.01397 *  
## Residuals  16 11.3446  0.7090                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>What does all this mean? We interpret each line of the ANOVA table in exactly the same way as we do for a one-way ANOVA. The first part tells us what kind of output we are looking at:</p>
<pre><code>## Analysis of Variance Table 
##  
## Response: Weight</code></pre>
<p>This reminds us that we are looking at an ANOVA table where we analysed a variable called <code>Weight</code>. The table contains the key information:</p>
<pre><code>##            Df  Sum Sq Mean Sq F value    Pr(&gt;F)     
## pH          1 19.9800 19.9800 28.1792 7.065e-05 *** 
## Calluna     1 10.2102 10.2102 14.4001   0.00159 **  
## pH:Calluna  1  5.3976  5.3976  7.6126   0.01397 *   
## Residuals  16 11.3446  0.7090</code></pre>
<p>This ANOVA table is similar to the ones we have already seen, except that now we have to consider three lines—one for each term in the model. The first is for the main effect of pH, the second for the main effect of <em>Calluna</em>, the third for the interaction between pH and <em>Calluna</em>.</p>
<p>The <em>F</em>-ratio is the test statistic for each term. These provides a measure of how large and consistent the effects associated with each term are. Each <em>F</em>-ratio has a pair of degrees of freedom associated with it: one belonging to the term itself, the other due to the error (residual). Together, the <em>F</em>-ratio and its degrees of freedom determines the <em>p</em>-value.</p>
<p>The <em>p</em>-value gives the probability that the differences between the set of means for each term in the model, or a more extreme difference, could have arisen through sampling variation under the null hypothesis of no difference. We take <em>p</em> &lt; 0.05 as evidence that at least one of the treatments is having an effect. Here, <em>p</em> &lt; 0.05 for three effects, so we conclude both main effects and the interaction are significant (though at different significance levels).</p>
<p>The ANOVA table tells us nothing about the direction of the effects. We have to delve a little further into the fitted model or plot the data to be able to do this. The presence of an interaction between treatments indicates that the impact of one factor depends on the levels of the other factor. This means that if there is a significant interaction in a two-way ANOVA, then the main effects should be interpreted with care.</p>
<p>An ‘interaction diagram’ provides a good way to think about these issues…</p>
<div id="understanding-the-model-graphically" class="section level3">
<h3><span class="header-section-number">28.6.1</span> Understanding the model graphically</h3>
<p>How should we go about interpreting the significant effects? To reiterate, the interaction tells us that the magnitude, or even direction, of the effect of one factor is dependent upon the levels of the other factor. In other words the treatment effects are contingent on one another. This contingency can arise in a number of ways, giving rise to different mixtures of main effects and interactions. This is illustrated most easily by considering some hypothetical results from a pH/<em>Calluna</em> experiment of this sort, in schematic form (the <em>Calluna</em> bars are linked by a dotted line):</p>
<p><img src="images/interaction-diagrams.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Diagrams such as these are sometimes called ‘interaction diagrams’ and they are often the best way of looking at the results from this sort of experiment to try and interpret what is happening. You will notice that the lines linking the treatments are parallel when there is no interaction, but become non-parallel when an interaction is present. An interaction may just mildly change the way the main effects work (4th plot) or it might completely reverse the effects (5th plot).</p>
<p>We can use R to produce an interaction diagram for a two-way design. We’ll use <code>dplyr</code> and <code>ggplot2</code> to construct this for the example. First we have to calculate the mean weight of <em>Festuca</em> in each treatment combination:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># step 1. calculate means for each treatment combination</span>
festuca_means &lt;-<span class="st"> </span>
<span class="st">  </span>festuca %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Calluna, pH) %&gt;%<span class="st"> </span><span class="co"># &lt;- remember to group by *both* factors</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Means =</span> <span class="kw">mean</span>(Weight))
festuca_means</code></pre></div>
<pre><code>## Source: local data frame [4 x 3]
## Groups: Calluna [?]
## 
##   Calluna     pH Means
##    &lt;fctr&gt; &lt;fctr&gt; &lt;dbl&gt;
## 1  Absent  pH3.5 3.368
## 2  Absent  pH5.5 6.406
## 3 Present  pH3.5 2.978
## 4 Present  pH5.5 3.938</code></pre>
<p>The key to making the plot is to specify <em>four</em> aesthetic mappings, and then add two layers, one showing points and the other showing lines:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># step 2. plot these as an interaction plot</span>
<span class="kw">ggplot</span>(festuca_means, 
       <span class="kw">aes</span>(<span class="dt">x =</span> Calluna, <span class="dt">y =</span> Means, <span class="dt">colour =</span> pH, <span class="dt">group =</span> pH)) +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>) +<span class="st"> </span><span class="kw">geom_line</span>()</code></pre></div>
<p><img src="stats-for-bio_files/figure-html/festuca-interact-diag-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Notice that we mapped pH to two aesthetics: colour and group. This ‘trick’ makes <code>ggplot2</code> link the levels of <code>pH</code> with lines, each of which gets its own colour.</p>
<p>This clearly reveals how the different effects are working. Our interaction plot resembles the 4th hypothetical outcome. It is possible to make some interpretation of the main effects—namely that increase in pH, and removal of <em>Calluna</em> increase <em>Festuca</em> yield. However, the magnitude of these effects is dependent on the other (interaction)—the effect of <em>Calluna</em> is increased at higher pH.</p>
</div>
</div>
<div id="multiple-comparison-tests-2" class="section level2">
<h2><span class="header-section-number">28.7</span> Multiple comparison tests</h2>
<p>Obviously, since the main treatments only have two levels there is no need for any multiple comparison tests on the main effects — if there is a difference it must be between the two levels. However, the interaction is significant, so it may be desirable to know which particular treatment combinations differ. Predictably, the work flow is very similar to that applied to a one-way ANOVA model.</p>
<p>We could use the <code>TukeyHSD</code> function to do this. We start by converting the model object produced by <code>lm</code> into an <code>aov</code> object…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">festuca_aov &lt;-<span class="st"> </span><span class="kw">aov</span>(festuca_model)</code></pre></div>
<p>…and then we perform a Tukey HSD test:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">TukeyHSD</span>(festuca_aov, <span class="dt">which =</span> <span class="st">&#39;pH:Calluna&#39;</span>)</code></pre></div>
<p>We have suppressed the output for now. The only new tweak that we have to learn is the <code>which</code> argument. Assigning this the value <code>'pH:Calluna'</code> makes the <code>TukeyHSD</code> function carry out all pairwise comparisons among the means of each treatment combination, i.e., we are considering the full set of interactions. Here is the output:</p>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = festuca_model)
## 
## $`pH:Calluna`
##                               diff        lwr        upr     p adj
## pH5.5:Absent-pH3.5:Absent    3.038  1.5143518  4.5616482 0.0001731
## pH3.5:Present-pH3.5:Absent  -0.390 -1.9136482  1.1336482 0.8826936
## pH5.5:Present-pH3.5:Absent   0.570 -0.9536482  2.0936482 0.7117913
## pH3.5:Present-pH5.5:Absent  -3.428 -4.9516482 -1.9043518 0.0000443
## pH5.5:Present-pH5.5:Absent  -2.468 -3.9916482 -0.9443518 0.0014155
## pH5.5:Present-pH3.5:Present  0.960 -0.5636482  2.4836482 0.3079685</code></pre>
<p>You extract information from this table just as you did before. The table present a series of pair-wise comparisons between mean values tested by the Tukey procedure. For example, the first 3 lines show the significance of differences between the mean of the treatment combination pH 3.5 without <em>Calluna</em> and the 3 other mean values. All we need from this table is to note the codes for the treatment means which are being compared (listed in the first column), and the <em>p</em>-value in each case listed in the final column.</p>
<p>If we list the mean values in sequence from the lowest to the highest we can then use the results presented in these tables of pair-wise comparisons to derive letter codes to indicate which means differ significantly (at <em>p</em>&lt;0.05) in exactly the same way as you did last week. There are three significant differences, all of which involve the treatment combinations pH 5.5 with <em>Calluna</em> absent. This implies that there are two ‘not significantly different’ groups: one defined by pH 5.5 with <em>Calluna</em> absent, and then everything else.</p>
<p>As you might expect, we don’t have to step through the results of the <code>TukeyHSD</code> function to define the ‘not significantly different’ groups. We used the <code>agricolae</code> package to do this for a one-way ANOVA. We can use this again here. We need to load and attach the package first (it may also need to be installed if you are on a university computer):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(agricolae)</code></pre></div>
<p>Once the package is ready for use, we can carry out the Tukey HSD test to find the ‘not significantly different’ groups using the <code>HSD.test</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">HSD.test</span>(festuca_aov, <span class="dt">trt =</span> <span class="kw">c</span>(<span class="st">&quot;pH&quot;</span>, <span class="st">&quot;Calluna&quot;</span>), <span class="dt">console =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
## Study: festuca_aov ~ c(&quot;pH&quot;, &quot;Calluna&quot;)
## 
## HSD Test for Weight 
## 
## Mean Square Error:  0.709035 
## 
## pH:Calluna,  means
## 
##               Weight       std r  Min  Max
## pH3.5:Absent   3.368 0.9042511 5 2.28 4.43
## pH3.5:Present  2.978 0.6089089 5 2.39 3.71
## pH5.5:Absent   6.406 0.9451614 5 5.25 7.45
## pH5.5:Present  3.938 0.8685448 5 3.04 5.21
## 
## alpha: 0.05 ; Df Error: 16 
## Critical Value of Studentized Range: 4.046093 
## 
## Honestly Significant Difference: 1.523648 
## 
## Means with the same letter are not significantly different.
## 
## Groups, Treatments and means
## a     pH5.5:Absent    6.406 
## b     pH5.5:Present   3.938 
## b     pH3.5:Absent    3.368 
## b     pH3.5:Present   2.978</code></pre>
<p>Setting the <code>trt</code> argument to <code>c(&quot;pH&quot;, &quot;Calluna&quot;)</code> makes the function carry out all pair-wise comparisons among the mean values defined by each treatment combination. The output that matters is the table at the very end, which shows the group identities as letters, the treatment names, and the treatment means. This just reiterates what we already knew—there are two ‘not significantly different’ groups, defined by pH 5.5 with <em>Calluna</em> absent, and ‘everything else’.</p>
<div class="advanced-box">
<p>
<strong>Multiple comparison tests for main effects</strong>
</p>
<p>
As mentioned above, in this experiment there is no point in trying to make further comparisons between the means from the main treatments (pH 3.5 and 5.5, or with and without <em>Calluna</em>) since (a) there is a significant interaction, so detailed comparisons of the main effects are hard to interpret, and (b) even if that was not the case there are only two levels in each treatment so any difference must be between those two levels!
</p>
<p>
However, it is quite common to have experiments with more than two levels in one or both factors. If the ANOVA indicates that there is a significant effect of one, or both, of the associated effects, and there is no interaction to worry about (don’t forget this caveat), then you may wish to carry out multiple comparisons for the means associated with the main effects.
</p>
<p>
This can be done using a Tukey test just as we did for the interaction in this example. The only difference is that we have to specify the name of the main effect you are interested in. For example, if we wanted to use <code>TukeyHSD</code> function to evaluate the significance of the <code>pH</code> main effects, we would use: <code>TukeyHSD(festuca_aov, which = ‘pH’)</code>
</p>
</div>
</div>
<div id="drawing-conclusions-and-presenting-results" class="section level2">
<h2><span class="header-section-number">28.8</span> Drawing conclusions and presenting results</h2>
<p>In the results section of the report we will need to provide a succinct factual summary of the analysis:</p>
<blockquote>
<p>There were significant effects of soil pH (ANOVA: F=28.18, df=1,16, <em>p</em>&lt;0.001), competition with <em>Calluna</em> (F=14.4, df=1,16, p=0.002) and the interaction between these treatments (F=7.61, df=1,16, p=0.014) on the dry weight yield of <em>Festuca</em>. <em>Festuca</em> grew much better in the absence of <em>Calluna</em> at high pH than in any other treatment combination (Tukey multiple comparison test <em>p</em>&lt;0.05) (Figure 1).</p>
</blockquote>
<p>For presentation we could tabulate the results, or better still present them as a figure rather like the interaction diagrams we saw earlier. We can of course produce such a figure, though we should include the standard errors of each mean to use it in a report or presentation. We’ll round off this section by looking at how to produce these publication-ready figures.</p>
<div class="do-something">
<p>
You won’t be assessed on your ability to produce summary plots such as those below. But yes, you should learn how to make them because you will need to produce these kinds of figures in your own projects. The good news is that the figures below are as complicated as things will get in this book.
</p>
</div>
<p>We want to plot some sample statistics (means and standard errors) so we first have to calculate these using <code>dplyr</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># step 1. calculate means for each treatment combination</span>
festuca_stats &lt;-<span class="st"> </span>
<span class="st">  </span>festuca %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Calluna, pH) %&gt;%<span class="st"> </span><span class="co"># &lt;- remember to group by the two factors</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Means =</span> <span class="kw">mean</span>(Weight), <span class="dt">SEs =</span> <span class="kw">sd</span>(Weight)/<span class="kw">sqrt</span>(<span class="kw">n</span>()))
festuca_stats</code></pre></div>
<pre><code>## Source: local data frame [4 x 4]
## Groups: Calluna [?]
## 
##   Calluna     pH Means       SEs
##    &lt;fctr&gt; &lt;fctr&gt; &lt;dbl&gt;     &lt;dbl&gt;
## 1  Absent  pH3.5 3.368 0.4043934
## 2  Absent  pH5.5 6.406 0.4226890
## 3 Present  pH3.5 2.978 0.2723123
## 4 Present  pH5.5 3.938 0.3884250</code></pre>
<p>Once we’ve constructed a data frame containing the descriptive statistics we can make a plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># step 2. plot these as an interaction plot</span>
<span class="kw">ggplot</span>(festuca_stats, 
       <span class="kw">aes</span>(<span class="dt">x =</span> Calluna, <span class="dt">y =</span> Means, <span class="dt">colour =</span> pH,
           <span class="dt">ymin =</span> Means -<span class="st"> </span>SEs, <span class="dt">ymax =</span> Means +<span class="st"> </span>SEs)) +
<span class="st">  </span><span class="co"># this adds the mean</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) +
<span class="st">  </span><span class="co"># this adds the error bars</span>
<span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">width =</span> <span class="fl">0.1</span>) +
<span class="st">  </span><span class="co"># controlling the appearance</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">7</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Calluna&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Festuca yield (g dry weight)&quot;</span>)</code></pre></div>
<p><img src="stats-for-bio_files/figure-html/festuca-summary-points-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>This is very similar to the <code>ggplot2</code> code used to make the summary figure in the one-way ANOVA example. We set the <code>data</code> argument in <code>ggplot</code> to be the data frame containing the statistics (not the original raw data), and this time, we set up <strong>five</strong> aesthetic mappings: <code>x</code>, <code>y</code>, <code>colour</code>, <code>ymin</code> and <code>ymax</code>. We use the colour aesthetic to delineate the levels of <code>pH</code>. We added two layers: one layer is added with <code>geom_point</code> to include the individual points based on the <code>x</code> and <code>y</code> mappings; the second layer is added with <code>geom_errorbar</code> to include the error bars based on the <code>x</code>, <code>ymin</code> and <code>ymax</code> mappings.</p>
<div id="a-little-more-customisation" class="section level3">
<h3><span class="header-section-number">28.8.1</span> A little more customisation</h3>
<p>It is not uncommon to find that two or more means are quite close to one another, and as a result, plotted points and/or standard errors overlap. We can tweak a figure to avoid this by moving the plotted points a little to one side. The trick is to use the <code>position_dodge</code> function to define a ‘position adjustment’ object, and then associated this with <code>position</code> arguments in <code>geom_errorbar</code> and <code>geom_point</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define a position adjustment </span>
pos &lt;-<span class="st"> </span><span class="kw">position_dodge</span>(<span class="fl">0.15</span>)
<span class="co"># make the plot</span>
<span class="kw">ggplot</span>(festuca_stats, 
       <span class="kw">aes</span>(<span class="dt">x =</span> Calluna, <span class="dt">y =</span> Means, <span class="dt">colour =</span> pH,
           <span class="dt">ymin =</span> Means -<span class="st"> </span>SEs, <span class="dt">ymax =</span> Means +<span class="st"> </span>SEs)) +
<span class="st">  </span><span class="co"># this adds the mean (shift positions with &#39;position =&#39;)</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">position =</span> pos) +
<span class="st">  </span><span class="co"># this adds the error bars (shift positions with &#39;position =&#39;)</span>
<span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">width =</span> <span class="fl">0.1</span>, <span class="dt">position =</span> pos) +
<span class="st">  </span><span class="co"># controlling the appearance</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">7</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Calluna&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Festuca yield (g dry weight)&quot;</span>)</code></pre></div>
<p><img src="stats-for-bio_files/figure-html/festuca-summary-dodge-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Look at the new positions of the points and error bars at each level of <code>Calluna</code>—they have shifted very slightly to the left and right. We don’t need to do this in the Calluna example of course, because there is no overlap to deal with. If the points/SEs had overlapped, this would now be avoided because the data would be plotted side-by-side.</p>
<p>We could also use a bar chart with error bars to summarise the data. You only have to change one thing about the last chunk of <code>ggplot2</code> code to make this. You can probably guess how to do this—instead of using a <code>geom_point</code>, we use <code>geom_bar</code>…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(festuca_stats, 
       <span class="kw">aes</span>(<span class="dt">x =</span> Calluna, <span class="dt">y =</span> Means, <span class="dt">fill =</span> pH,
           <span class="dt">ymin =</span> Means -<span class="st"> </span>SEs, <span class="dt">ymax =</span> Means +<span class="st"> </span>SEs)) +
<span class="st">  </span><span class="co"># this adds the mean</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>()) +
<span class="st">  </span><span class="co"># this adds the error bars</span>
<span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.9</span>), <span class="dt">width=</span>.<span class="dv">2</span>) +
<span class="st">  </span><span class="co"># controlling the appearance</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Calluna&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Festuca yield (g dry weight)&quot;</span>)</code></pre></div>
<p><img src="stats-for-bio_files/figure-html/festuca-summary-bar-1.png" width="326.4" style="display: block; margin: auto;" /> Remember (one more time) that we have to set the <code>stat</code> argument of <code>geom_bar</code> to <code>&quot;identity&quot;</code> to ensure it plots the y variable ‘as is’. The only other other trick we need to apply is to set the <code>position</code> arguments of <code>geom_errorbar</code> and <code>geom_bar</code> using <code>position_dodge</code>. If we don’t do this, <code>ggplot2</code> will produce a stacked bar chart and the error bars will end up in the wrong place (the value of 0.9 used in <code>position_dodge(0.9)</code> ensures the error bars appear in the centre of each bar).</p>
</div>
</div>
<div id="balanced-or-orthogonal-designs" class="section level2">
<h2><span class="header-section-number">28.9</span> Balanced or orthogonal designs</h2>
<p>We’re going to finish this chapter with a small warning. In an ideal world, for ANOVA with two or more factors the experiment should be designed such that we have: 1) every possible combination of treatments represented, e.g. pH and <em>Calluna</em> factors each have two levels, so the experiment should have four treatment combinations; 2) equal numbers of replicates in each combination of treatments, e.g. all the cells in the data table for pH and <em>Calluna</em> treatments have equal numbers of data values. This leads to what is called a balanced, orthogonal experiment. The word balanced refers to the ‘equal numbers of replicates in each combination’ aspect of the experiment. The word orthogonal refers to the ‘every possible combination of treatments’ aspect of the experiment.</p>
<p><strong>The analysis workflow that we learn in this book assumes a balanced, orthogonal experimental design</strong>. We put that in bold because it is a really important point to remember. If at all possible, aim for a balanced, orthogonal experimental design. This makes life much easier when the time comes to analyse the data. The workflow we’re learning is only appropriate when using balanced, orthogonal design. If our experimental design does not meet these conditions, it is not necessarily a problem, but we need to consider its limitations. What are these? Here’s the key one: we can’t just take the fitted model object and pass it to the <code>anova</code> function to carry out the significance tests. We have to be a lot more careful than that.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-two-way-anova.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="anova-for-randomised-block-designs.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dzchilds/stats-for-bio/edit/master/7_02_two_way_anova_R.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"split_by": "section"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
